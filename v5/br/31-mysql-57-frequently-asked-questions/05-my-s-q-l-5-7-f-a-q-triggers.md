## A.5 FAQ do MySQL 5.7: Triggers

A.5.1. [Onde posso encontrar a documentação para os Triggers do MySQL 5.7?](faqs-triggers.html#faq-mysql-where-triggers-docs)

A.5.2. [Existe um fórum de discussão para Triggers do MySQL?](faqs-triggers.html#faq-mysql-where-triggers-forum)

A.5.3. [O MySQL possui Triggers statement-level ou row-level?](faqs-triggers.html#faq-mysql-have-trigger-levels)

A.5.4. [Existem Triggers padrão?](faqs-triggers.html#faq-mysql-have-trigger-defaults)

A.5.5. [Como os Triggers são gerenciados no MySQL?](faqs-triggers.html#faq-mysql-how-triggers-managed)

A.5.6. [Existe uma maneira de visualizar todos os Triggers em um determinado Database?](faqs-triggers.html#faq-mysql-can-view-all-triggers)

A.5.7. [Onde os Triggers são armazenados?](faqs-triggers.html#faq-mysql-how-triggers-stored)

A.5.8. [Um Trigger pode chamar uma stored procedure?](faqs-triggers.html#faq-mysql-can-trigger-procedure)

A.5.9. [Os Triggers podem acessar Tables?](faqs-triggers.html#faq-mysql-can-triggers-tables)

A.5.10. [Uma Table pode ter múltiplos Triggers com o mesmo evento e tempo de ação?](faqs-triggers.html#faq-mysql-can-triggers-same-events)

A.5.11. [É possível para um Trigger atualizar Tables em um servidor remoto?](faqs-triggers.html#faq-mysql-can-triggers-remote)

A.5.12. [Os Triggers funcionam com Replication?](faqs-triggers.html#faq-mysql-can-triggers-replication)

A.5.13. [Como as ações realizadas por meio de Triggers em um Source são replicadas para uma Replica?](faqs-triggers.html#faq-mysql-how-triggers-source-replica)

<table border="0" style="width: 100%;"><colgroup><col align="left" width="1%"/><col/></colgroup><tbody><tr class="question"><td align="left" valign="top"><p><b>A.5.1.</b></p></td><td align="left" valign="top"><p> Onde posso encontrar a documentação para os Triggers do MySQL 5.7? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Consulte a Seção 23.3, “Usando Triggers”. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.2.</b></p></td><td align="left" valign="top"><p> Existe um fórum de discussão para Triggers do MySQL? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Sim. Ele está disponível em https://forums.mysql.com/list.php?99. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.3.</b></p></td><td align="left" valign="top"><p> O MySQL possui Triggers statement-level ou row-level? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Todos os Triggers são <code>FOR EACH ROW</code>; ou seja, o Trigger é ativado para cada row que é inserida, atualizada (updated) ou excluída (deleted). O MySQL não oferece suporte a Triggers usando <code>FOR EACH STATEMENT</code>. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.4.</b></p></td><td align="left" valign="top"><p> Existem Triggers padrão? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Não explicitamente. O MySQL tem um comportamento especial específico para algumas colunas <code>TIMESTAMP</code>, bem como para colunas definidas usando <code>AUTO_INCREMENT</code>. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.5.</b></p></td><td align="left" valign="top"><p> Como os Triggers são gerenciados no MySQL? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Triggers podem ser criados usando a instrução <code>CREATE TRIGGER</code> e descartados usando <code>DROP TRIGGER</code>. Consulte a Seção 13.1.20, “Instrução CREATE TRIGGER”, e a Seção 13.1.31, “Instrução DROP TRIGGER”, para saber mais sobre essas instruções. </p><p> Informações sobre Triggers podem ser obtidas fazendo uma Query na Table <code>INFORMATION_SCHEMA.TRIGGERS</code>. Consulte a Seção 24.3.29, “A Tabela INFORMATION_SCHEMA TRIGGERS”. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.6.</b></p></td><td align="left" valign="top"><p> Existe uma maneira de visualizar todos os Triggers em um determinado Database? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Sim. Você pode obter uma listagem de todos os Triggers definidos no Database <code>dbname</code> usando uma Query na Table <code>INFORMATION_SCHEMA.TRIGGERS</code>, como a mostrada aqui: </p><pre class="programlisting copytoclipboard language-sql"><code class="language-sql">SELECT TRIGGER_NAME, EVENT_MANIPULATION, EVENT_OBJECT_TABLE, ACTION_STATEMENT FROM INFORMATION_SCHEMA.TRIGGERS WHERE TRIGGER_SCHEMA='<em>dbname</em>';</code></pre><p> Para mais informações sobre esta Table, consulte a Seção 24.3.29, “A Tabela INFORMATION_SCHEMA TRIGGERS”. </p><p> Você também pode usar a instrução <code>SHOW TRIGGERS</code>, que é específica do MySQL. Consulte a Seção 13.7.5.38, “Instrução SHOW TRIGGERS”. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.7.</b></p></td><td align="left" valign="top"><p> Onde os Triggers são armazenados? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Triggers são armazenados em arquivos <code>.TRG</code>, sendo um arquivo para cada Table. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.8.</b></p></td><td align="left" valign="top"><p> Um Trigger pode chamar uma stored procedure? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Sim. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.9.</b></p></td><td align="left" valign="top"><p> Os Triggers podem acessar Tables? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Um Trigger pode acessar dados old e new em sua própria Table. Um Trigger também pode afetar outras Tables, mas não é permitido modificar uma Table que já esteja sendo usada (para leitura ou escrita) pela instrução que invocou a função ou o Trigger. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.10.</b></p></td><td align="left" valign="top"><p> Uma Table pode ter múltiplos Triggers com o mesmo evento e tempo de ação? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> É possível definir múltiplos Triggers para uma determinada Table que tenham o mesmo evento e tempo de ação. Por exemplo, você pode ter dois Triggers <code>BEFORE UPDATE</code> para uma Table. Por padrão, Triggers que têm o mesmo evento e tempo de ação são ativados na ordem em que foram criados. Para afetar a ordem dos Triggers, especifique uma cláusula após <code>FOR EACH ROW</code> que indique <code>FOLLOWS</code> ou <code>PRECEDES</code> e o nome de um Trigger existente que também tenha o mesmo evento e tempo de ação. Com <code>FOLLOWS</code>, o novo Trigger é ativado após o Trigger existente. Com <code>PRECEDES</code>, o novo Trigger é ativado antes do Trigger existente. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.11.</b></p></td><td align="left" valign="top"><p> É possível para um Trigger atualizar Tables em um servidor remoto? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Sim. Uma Table em um servidor remoto pode ser atualizada usando o storage engine <code>FEDERATED</code>. (Consulte a Seção 15.8, “O Storage Engine FEDERATED”). </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.12.</b></p></td><td align="left" valign="top"><p> Os Triggers funcionam com Replication? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Sim. No entanto, a forma como eles funcionam depende se você está usando o formato de Replication baseado em Statement (“clássico”) ou baseado em Row do MySQL. </p><p> Ao usar Replication baseada em Statement, os Triggers na Replica são executados pelas Statements que são executadas no Source (e replicadas para a Replica). </p><p> Ao usar Replication baseada em Row, os Triggers não são executados na Replica devido às Statements que foram executadas no Source e depois replicadas para a Replica. Em vez disso, ao usar Replication baseada em Row, as alterações causadas pela execução do Trigger no Source são aplicadas na Replica. </p><p> Para mais informações, consulte a Seção 16.4.1.34, “Replication e Triggers”. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.5.13.</b></p></td><td align="left" valign="top"><p> Como as ações realizadas por meio de Triggers em um Source são replicadas para uma Replica? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Novamente, isso depende se você está usando Replication baseada em Statement ou baseada em Row. </p><p><b>Replication baseada em Statement. </b> Primeiro, os Triggers que existem em um Source devem ser recriados no servidor Replica. Feito isso, o fluxo de Replication funciona como qualquer outra instrução DML padrão que participa da Replication. Por exemplo, considere uma Table <code>EMP</code> que possui um Trigger <code>AFTER INSERT</code>, que existe em um servidor Source de Replication. A mesma Table <code>EMP</code> e o mesmo Trigger <code>AFTER INSERT</code> também existem no servidor Replica. O fluxo de Replication seria: </p> <div class="orderedlist"> <ol class="orderedlist" type="1"><li class="listitem"><p> Uma instrução <code>INSERT</code> é feita em <code>EMP</code>. </p></li><li class="listitem"><p> O Trigger <code>AFTER</code> em <code>EMP</code> é ativado. </p></li><li class="listitem"><p> A instrução <code>INSERT</code> é escrita no Binary Log. </p></li><li class="listitem"><p> A Replica recebe a instrução <code>INSERT</code> para <code>EMP</code> e a executa. </p></li><li class="listitem"><p> O Trigger <code>AFTER</code> em <code>EMP</code> que existe na Replica é ativado. </p></li></ol> </div> <p><b>Replication baseada em Row. </b> Ao usar Replication baseada em Row, as alterações causadas pela execução do Trigger no Source são aplicadas na Replica. No entanto, os próprios Triggers não são realmente executados na Replica sob Replication baseada em Row. Isso ocorre porque, se tanto o Source quanto a Replica aplicassem as alterações do Source e, além disso, o Trigger que causa essas alterações fosse aplicado na Replica, as alterações seriam, na verdade, aplicadas duas vezes na Replica, levando a dados diferentes no Source e na Replica. </p><p> Na maioria dos casos, o resultado é o mesmo para Replication baseada em Row e baseada em Statement. No entanto, se você usar Triggers diferentes no Source e na Replica, você não pode usar Replication baseada em Row. (Isso ocorre porque o formato baseado em Row replica as alterações feitas pelos Triggers que estão sendo executados no Source para as Replicas, em vez das Statements que fizeram com que os Triggers fossem executados, e os Triggers correspondentes na Replica não são executados.) Em vez disso, quaisquer Statements que causem a execução de tais Triggers devem ser replicadas usando Replication baseada em Statement. </p><p> Para mais informações, consulte a Seção 16.4.1.34, “Replication e Triggers”. </p></td></tr></tbody></table>