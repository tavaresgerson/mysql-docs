## A.4 Perguntas frequentes sobre o MySQL 5.7: Procedimentos e funções armazenadas

A.4.1. [O MySQL suporta procedimentos e funções armazenadas?](faqs-stored-procs.html#faq-mysql-have-procedures-functions)

A.4.2. [Onde posso encontrar documentação para procedimentos e funções armazenadas no MySQL?](faqs-stored-procs.html#faq-mysql-onde-procedimentos-funcoes-docs)

A.4.3. [Há um fórum de discussão para procedimentos armazenados MySQL?](faqs-stored-procs.html#faq-mysql-onde-está-o-fórum-de-procedimentos)

A.4.4. [Onde posso encontrar a especificação ANSI SQL 2003 para procedimentos armazenados?](faqs-stored-procs.html#faq-mysql-onde-esta-a-especificacao-ansi-2003)

A.4.5. [Como você gerencia rotinas armazenadas?](faqs-stored-procs.html#faq-mysql-como-gerenciar-rotinas)

A.4.6. [Existe uma maneira de visualizar todos os procedimentos e funções armazenadas em um banco de dados específico?](faqs-stored-procs.html#faq-mysql-como-visualizar-procedimentos-funcoes)

A.4.7. [Onde os procedimentos armazenados são armazenados?](faqs-stored-procs.html#faq-mysql-onde-procedimentos-sao-armazenados)

A.4.8. [É possível agrupar procedimentos ou funções armazenadas em pacotes?](faqs-stored-procs.html#faq-mysql-como-agrupar-procedimentos-funcoes)

A.4.9. [Uma procedure armazenada pode chamar outra procedure armazenada?](faqs-stored-procs.html#faq-mysql-can-procedure-call-procedure)

A.4.10. [Um procedimento armazenado pode chamar um gatilho?](faqs-stored-procs.html#faq-mysql-can-procedure-call-trigger)

A.4.11. [Um procedimento armazenado pode acessar tabelas?](faqs-stored-procs.html#faq-mysql-pode-procedimento-acessar-tabela)

A.4.12. [Os procedimentos armazenados têm uma declaração para levantar erros de aplicativo?](faqs-stored-procs.html#faq-mysql-can-procedure-raise-error)

A.4.13. [Os procedimentos armazenados oferecem tratamento de exceções?](faqs-stored-procs.html#faq-mysql-have-exceptions)

A.4.14. [As rotinas armazenadas do MySQL podem retornar conjuntos de resultados?](faqs-stored-procs.html#faq-mysql-can-routine-results)

A.4.15. [O WITH RECOMPILE é suportado para procedimentos armazenados?](faqs-stored-procs.html#faq-mysql-have-with-recompile)

A.4.16. [Existe um equivalente do MySQL para usar o mod\_plsql como um gateway no Apache para falar diretamente com um procedimento armazenado no banco de dados?](faqs-stored-procs.html#faq-mysql-have-mod-plsql)

A.4.17. [Posso passar um array como entrada para um procedimento armazenado?](faqs-stored-procs.html#faq-mysql-can-procedure-array)

A.4.18. [Posso passar um cursor como parâmetro IN para um procedimento armazenado?](faqs-stored-procs.html#faq-mysql-can-pass-cursor-in)

A.4.19. [Posso retornar um cursor como um parâmetro OUT de um procedimento armazenado?](faqs-stored-procs.html#faq-mysql-can-return-cursor-out)

A.4.20. [Posso imprimir o valor de uma variável dentro de uma rotina armazenada para fins de depuração?](faqs-stored-procs.html#faq-mysql-can-print-var-in-procedure)

A.4.21. [Posso comprometer ou reverter transações dentro de um procedimento armazenado?](faqs-stored-procs.html#faq-mysql-can-rollback-transaction-procedure)

A.4.22. [Os procedimentos e funções armazenados no MySQL funcionam com replicação?](faqs-stored-procs.html#faq-mysql-can-procedures-replicatation)

A.4.23. [Os procedimentos e funções armazenados criados em um servidor de origem de replicação são replicados para uma réplica?](faqs-stored-procs.html#faq-mysql-são-procedimentos-replicados)

A.4.24. [Como as ações que ocorrem dentro de procedimentos e funções armazenadas são replicadas?](faqs-stored-procs.html#faq-mysql-como-procedimentos-são-replicados)

A.4.25. [Existem requisitos de segurança especiais para o uso de procedimentos e funções armazenados juntamente com a replicação?](faqs-stored-procs.html#faq-mysql-security-procedures-replication)

A.4.26. [Quais são as limitações para a replicação de procedimentos armazenados e ações de funções?](faqs-stored-procs.html#faq-mysql-limitacoes-procedimentos-replicacao)

A.4.27. [As limitações anteriores afetam a capacidade do MySQL de realizar a recuperação em um ponto no tempo?](faqs-stored-procs.html#faq-mysql-limitations-pit-recovery)

A.4.28. [O que está sendo feito para corrigir as limitações mencionadas anteriormente?](faqs-stored-procs.html#faq-mysql-quando-limitacoes-resolvidas)

<table border="0" style="width: 100%;"><colgroup><col align="left" width="1%"/><col/></colgroup><tbody><tr class="question"><td align="left" valign="top"><a name="faq-mysql-have-procedures-functions"></a><a name="id380537"></a><p><b>A.4.1.</b></p></td><td align="left" valign="top"><p>O MySQL suporta procedimentos e funções armazenadas?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim. O MySQL suporta dois tipos de rotinas armazenadas: procedimentos armazenados e funções armazenadas.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-where-procedures-functions-docs"></a><a name="id380542"></a><p><b>A.4.2.</b></p></td><td align="left" valign="top"><p>Onde posso encontrar documentação para procedimentos e funções armazenadas no MySQL?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Veja<a class="xref" href="stored-routines.html" title="23.2 Uso de Rotinas Armazenadas">Seção 23.2, “Usando Rotinas Armazenadas”</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-where-procedures-forum"></a><a name="id380548"></a><p><b>A.4.3.</b></p></td><td align="left" valign="top"><p>Há um fórum de discussão para procedimentos armazenados do MySQL?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim. Veja<a class="ulink" href="https://forums.mysql.com/list.php?98" target="_blank">https://forums.mysql.com/list.php?98</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-where-ansi-2003-spec"></a><a name="id380554"></a><p><b>A.4.4.</b></p></td><td align="left" valign="top"><p>Onde posso encontrar a especificação ANSI SQL 2003 para procedimentos armazenados?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Infelizmente, as especificações oficiais não estão disponíveis gratuitamente (a ANSI as disponibiliza para compra). No entanto, existem livros, como<em class="citetitle">SQL-99 Completo, de verdade</em>por Peter Gulutzan e Trudy Pelzer, que oferecem uma visão abrangente do padrão, incluindo a cobertura de procedimentos armazenados.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-how-manage-routines"></a><a name="id380560"></a><p><b>A.4.5.</b></p></td><td align="left" valign="top"><p>Como você gerencia rotinas armazenadas?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>É sempre uma boa prática usar um esquema de nomeação claro para suas rotinas armazenadas. Você pode gerenciar procedimentos armazenados com [[PH_HTML_CODE_<code>SHOW CREATE PROCEDURE</code>], [[PH_HTML_CODE_<code>SHOW CREATE PROCEDURE</code>], [[PH_HTML_CODE_<code>mysql</code>] e [[PH_HTML_CODE_<code>INFORMATION_SCHEMA</code>]. Você pode obter informações sobre procedimentos armazenados existentes usando o<a class="link" href="information-schema-routines-table.html" title="24.3.21 A tabela Tabela de rotinas do esquema de informações">[[PH_HTML_CODE_<code>ROUTINES</code>]</a>tabela no banco de dados [[PH_HTML_CODE_<code>PARAMETERS</code>] (veja<a class="xref" href="information-schema-routines-table.html" title="24.3.21 A tabela Tabela de rotinas do esquema de informações">Seção 24.3.21, “A tabela INFORMATION_SCHEMA ROUTINES”</a>).</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-how-view-procedures-functions"></a><a name="id380573"></a><p><b>A.4.6.</b></p></td><td align="left" valign="top"><p>Existe uma maneira de visualizar todos os procedimentos e funções armazenadas em um banco de dados específico?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim. Para um banco de dados chamado<em class="replaceable">[[PH_HTML_CODE_<code>SHOW CREATE FUNCTION</code>]</em>, use esta consulta no<a class="link" href="information-schema-routines-table.html" title="24.3.21 A tabela Tabela de rotinas do esquema de informações">[[PH_HTML_CODE_<code>SHOW CREATE PROCEDURE</code>]</a>tabela:</p><pre class="programlisting copytoclipboard language-sql">[[PH_HTML_CODE_<code>UPDATE</code>]</pre><p>Para mais informações, consulte<a class="xref" href="information-schema-routines-table.html" title="24.3.21 A tabela Tabela de rotinas do esquema de informações">Seção 24.3.21, “A tabela INFORMATION_SCHEMA ROUTINES”</a>.</p><p>O corpo de uma rotina armazenada pode ser visualizado usando<a class="link" href="show-create-function.html" title="13.7.5.8. Declaração [[PH_BACKTICK_4<code>INFORMATION_SCHEMA</code>]">[[PH_HTML_CODE_<code>SIGNAL</code>]</a>(para uma função armazenada) ou<a class="link" href="show-create-procedure.html" title="13.7.5.9 Declaração [[PH_BACKTICK_4<code>ROUTINES</code>]">[[<code>SHOW CREATE PROCEDURE</code>]]</a>(para um procedimento armazenado). Veja<a class="xref" href="show-create-procedure.html" title="13.7.5.9 Declaração [[PH_BACKTICK_4<code>PARAMETERS</code>]">Seção 13.7.5.9, “Instrução SHOW CREATE PROCEDURE”</a>, para mais informações.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-where-procedures-stored"></a><a name="id380591"></a><p><b>A.4.7.</b></p></td><td align="left" valign="top"><p>Onde os procedimentos armazenados são armazenados?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Na tabela [[<code>ALTER [FUNCTION|PROCEDUR<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code></code><code>SHOW CREATE PROCEDURE</code>] do banco de dados do sistema [[<code>mysql</code>]]. No entanto, você não deve acessar as tabelas no banco de dados do sistema diretamente. Em vez disso, consulte o [[<code>INFORMATION_SCHEMA</code>]]<a class="link" href="information-schema-routines-table.html" title="24.3.21 A tabela Tabela de rotinas do esquema de informações">[[<code>ROUTINES</code>]]</a>e<a class="link" href="information-schema-parameters-table.html" title="24.3.15 A tabela INFORMATION_SCHEMA PARAMETERS">[[<code>PARAMETERS</code>]]</a>verifique as tabelas. Veja<a class="xref" href="information-schema-routines-table.html" title="24.3.21 A tabela Tabela de rotinas do esquema de informações">Seção 24.3.21, “A tabela INFORMATION_SCHEMA ROUTINES”</a>, e<a class="xref" href="information-schema-parameters-table.html" title="24.3.15 A tabela INFORMATION_SCHEMA PARAMETERS">Seção 24.3.15, “A tabela INFORMATION_SCHEMA PARAMETERS”</a>.</p><p>Você também pode usar<a class="link" href="show-create-function.html" title="13.7.5.8. Declaração [[PH_BACKTICK_4<code>SHOW CREATE FUNCTION</code>]">[[<code>SHOW CREATE FUNCTION</code>]]</a>para obter informações sobre as funções armazenadas, e<a class="link" href="show-create-procedure.html" title="13.7.5.9 Declaração [[PH_BACKTICK_4<code>SHOW CREATE PROCEDURE</code>]">[[<code>SHOW CREATE PROCEDURE</code>]]</a>para obter informações sobre procedimentos armazenados. Veja<a class="xref" href="show-create-procedure.html" title="13.7.5.9 Declaração [[PH_BACKTICK_4<code>UPDATE</code>]">Seção 13.7.5.9, “Instrução SHOW CREATE PROCEDURE”</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-how-group-procedures-functions"></a><a name="id380611"></a><p><b>A.4.8.</b></p></td><td align="left" valign="top"><p>É possível agrupar procedimentos armazenados ou funções armazenadas em pacotes?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Não. Isso não é suportado no MySQL.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-procedure-call-procedure"></a><a name="id380616"></a><p><b>A.4.9.</b></p></td><td align="left" valign="top"><p>Uma procedure armazenada pode chamar outra procedure armazenada?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-procedure-call-trigger"></a><a name="id380621"></a><p><b>A.4.10.</b></p></td><td align="left" valign="top"><p>Uma procedure armazenada pode chamar um trigger?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Um procedimento armazenado pode executar uma instrução SQL, como uma<a class="link" href="update.html" title="13.2.11 Declaração de atualização">[[<code>UPDATE</code>]]</a>, que faz com que um gatilho seja ativado.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-procedure-access-table"></a><a name="id380628"></a><p><b>A.4.11.</b></p></td><td align="left" valign="top"><p>Uma procedure armazenada pode acessar tabelas?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim. Um procedimento armazenado pode acessar uma ou mais tabelas conforme necessário.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-procedure-raise-error"></a><a name="id380633"></a><p><b>A.4.12.</b></p></td><td align="left" valign="top"><p>Os procedimentos armazenados têm uma declaração para levantar erros de aplicativo?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim. O MySQL implementa as instruções SQL [[<code>SIGNAL</code>]] e [[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>SHOW CREATE PROCEDURE</code>]. Veja<a class="xref" href="condition-handling.html" title="13.6.7 Tratamento de Condições">Seção 13.6.7, “Tratamento de Condições”</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-have-exceptions"></a><a name="id380641"></a><p><b>A.4.13.</b></p></td><td align="left" valign="top"><p>Os procedimentos armazenados oferecem tratamento de exceções?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>MySQL implementa<a class="link" href="handler.html" title="13.2.4 Declaração do Gestor">[[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>SHOW CREATE PROCEDURE</code>]</a>Definições de acordo com o padrão SQL. Veja<a class="xref" href="declare-handler.html" title="13.6.7.2 DECLARAR ... declaração do manipulador">Seção 13.6.7.2, “DECLARAR ... Declaração de Manipulador”</a>, para mais detalhes.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-routine-results"></a><a name="id380649"></a><p><b>A.4.14.</b></p></td><td align="left" valign="top"><p>As rotinas armazenadas do MySQL podem retornar conjuntos de resultados?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> <span class="emphasis"><em>Procedimentos armazenados</em></span>Pode, mas as funções armazenadas não podem. Se você executar uma função comum<a class="link" href="select.html" title="13.2.9 Instrução SELECT">[[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>mysql</code>]</a>Dentro de um procedimento armazenado, o conjunto de resultados é retornado diretamente ao cliente. Você precisa usar o protocolo cliente/servidor MySQL 4.1 (ou superior) para que isso funcione. Isso significa, por exemplo, que, no PHP, você precisa usar a extensão [[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>INFORMATION_SCHEMA</code>] em vez da antiga extensão [[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>ROUTINES</code>].</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-have-with-recompile"></a><a name="id380659"></a><p><b>A.4.15.</b></p></td><td align="left" valign="top"><p>O [[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>PARAMETERS</code>] é suportado para procedimentos armazenados?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Não.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-have-mod-plsql"></a><a name="id380665"></a><p><b>A.4.16.</b></p></td><td align="left" valign="top"><p>Existe um equivalente do MySQL para usar [[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>SHOW CREATE FUNCTION</code>] como um gateway no Apache para falar diretamente com um procedimento armazenado no banco de dados?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Não há equivalente no MySQL.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-procedure-array"></a><a name="id380671"></a><p><b>A.4.17.</b></p></td><td align="left" valign="top"><p>Posso passar um array como entrada para um procedimento armazenado?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Não.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-pass-cursor-in"></a><a name="id380676"></a><p><b>A.4.18.</b></p></td><td align="left" valign="top"><p>Posso passar um cursor como um parâmetro [[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>SHOW CREATE PROCEDURE</code>] para um procedimento armazenado?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Os cursor são apenas disponíveis dentro de procedimentos armazenados.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-return-cursor-out"></a><a name="id380682"></a><p><b>A.4.19.</b></p></td><td align="left" valign="top"><p>Posso retornar um cursor como um parâmetro [[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>UPDATE</code>] de um procedimento armazenado?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Os cursor estão disponíveis apenas dentro de procedimentos armazenados. No entanto, se você não abrir um cursor em um procedimento armazenado, ele não estará disponível.<a class="link" href="select.html" title="13.2.9 Instrução SELECT">[[<code>DROP [FUNCTION|PROCEDUR<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code></code><code>SIGNAL</code>]</a>, o resultado é enviado diretamente ao cliente. Você também pode [[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>SHOW CREATE PROCEDURE</code>] variáveis. Veja<a class="xref" href="select.html" title="13.2.9 Instrução SELECT">Seção 13.2.9, “Instrução SELECT”</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-print-var-in-procedure"></a><a name="id380692"></a><p><b>A.4.20.</b></p></td><td align="left" valign="top"><p>Posso imprimir o valor de uma variável dentro de uma rotina armazenada para fins de depuração?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim, você pode fazer isso em um<span class="emphasis"><em>procedimento armazenado</em></span>, mas não em uma função armazenada. Se você executar uma função comum<a class="link" href="select.html" title="13.2.9 Instrução SELECT">[[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>SHOW CREATE PROCEDURE</code>]</a>Dentro de um procedimento armazenado, o conjunto de resultados é retornado diretamente ao cliente. Você deve usar o protocolo cliente/servidor MySQL 4.1 (ou superior) para que isso funcione. Isso significa, por exemplo, que, no PHP, você precisa usar a extensão [[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>mysql</code>] em vez da antiga extensão [[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>INFORMATION_SCHEMA</code>].</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-rollback-transaction-procedure"></a><a name="id380702"></a><p><b>A.4.21.</b></p></td><td align="left" valign="top"><p>Posso comprometer ou reverter transações dentro de um procedimento armazenado?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim. No entanto, você não pode realizar operações transacionais dentro de uma função armazenada.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-can-procedures-replicatation"></a><a name="id380707"></a><p><b>A.4.22.</b></p></td><td align="left" valign="top"><p>Os procedimentos e funções armazenadas do MySQL funcionam com a replicação?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim, as ações padrão realizadas em procedimentos e funções armazenadas são replicadas de um servidor de origem de replicação para uma réplica. Existem algumas limitações que são descritas em detalhes no<a class="xref" href="stored-programs-logging.html" title="23.7 Registro binário de programas armazenados">Seção 23.7, “Registro de Log de Binário de Programa Armazenado”</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-are-procedures-replicated"></a><a name="id380713"></a><p><b>A.4.23.</b></p></td><td align="left" valign="top"><p>Os procedimentos e funções armazenados criados em um servidor de origem de replicação são replicados para uma réplica?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim, a criação de procedimentos armazenados e funções realizadas por meio de declarações normais de DDL em um servidor de origem de replicação é replicada para uma replica, de modo que os objetos existam em ambos os servidores. As declarações [[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>ROUTINES</code>] e [[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>PARAMETERS</code>] para procedimentos armazenados e funções também são replicadas.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-how-procedures-replicated"></a><a name="id380720"></a><p><b>A.4.24.</b></p></td><td align="left" valign="top"><p>Como as ações que ocorrem dentro de procedimentos e funções armazenadas são replicadas?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>O MySQL registra cada evento de DML que ocorre em um procedimento armazenado e replica essas ações individuais para uma replica. As chamadas reais feitas para executar procedimentos armazenados não são replicadas.</p><p>As funções armazenadas que alteram dados são registradas como chamadas de função, e não como os eventos de DML que ocorrem dentro de cada função.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-security-procedures-replication"></a><a name="id380726"></a><p><b>A.4.25.</b></p></td><td align="left" valign="top"><p>Existem requisitos de segurança especiais para o uso de procedimentos e funções armazenados juntamente com a replicação?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Sim. Porque uma réplica tem autoridade para executar qualquer declaração lida de um log binário de uma fonte. Existem restrições de segurança especiais para o uso de funções armazenadas com replicação. Se a replicação ou o registro binário estiverem ativos (com o propósito de recuperação em um ponto no tempo), os administradores de banco de dados MySQL têm duas opções de segurança abertas para eles:</p> <div class="orderedlist"> <ol class="orderedlist" type="1"><li class="listitem"><p>Qualquer usuário que deseje criar funções armazenadas deve ter permissão para isso.<a class="link" href="privileges-provided.html#priv_super">[[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>SHOW CREATE FUNCTION</code>]</a>prêmio.</p></li><li class="listitem"><p>Alternativamente, um DBA pode definir<a class="link" href="replication-options-binary-log.html#sysvar_log_bin_trust_function_creators">[[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>SHOW CREATE PROCEDURE</code>]</a>var de sistema para 1, o que permite que qualquer pessoa com o padrão<a class="link" href="privileges-provided.html#priv_create-routine">[[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>UPDATE</code>]</a>privilegio de criar funções armazenadas.</p></li></ol> </div> <p> </p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-limitations-procedures-replication"></a><a name="id380742"></a><p><b>A.4.26.</b></p></td><td align="left" valign="top"><p>Quais são as limitações para a replicação de ações de procedimentos e funções armazenadas?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Ações não determinísticas (aleatórias) ou baseadas em tempo incorporadas em procedimentos armazenados podem não se replicar corretamente. Por sua própria natureza, os resultados produzidos aleatoriamente não são previsíveis e não podem ser exatamente reproduzidos; portanto, ações aleatórias replicadas para uma replica não refletem aquelas realizadas em uma fonte. Declarar funções armazenadas como [[<code>SHOW CREATE [FUNCTION|PROCEDUR<code>ROUTINES</code></code><code>SIGNAL</code>] ou definir a<a class="link" href="replication-options-binary-log.html#sysvar_log_bin_trust_function_creators">[[<code>ROUTINES</code><code>SHOW CREATE PROCEDURE</code>]</a>A variável de sistema para 0 impede que operações aleatórias que produzem valores aleatórios sejam invocadas.</p><p>Além disso, ações baseadas em tempo não podem ser reproduzidas em uma réplica porque o cronometramento dessas ações em um procedimento armazenado não é reproduzível através do log binário usado para a replicação. Ele registra apenas eventos de DML e não leva em conta as restrições de cronometragem.</p><p>Por fim, tabelas não transacionais nas quais ocorrem erros durante ações grandes de DML (como inserções em lote) podem apresentar problemas de replicação, pois uma fonte pode ser parcialmente atualizada devido à atividade de DML, mas nenhuma atualização é feita na replica devido aos erros que ocorreram. Uma solução é que as ações de DML de uma função sejam realizadas com a palavra-chave [[<code>ROUTINES</code><code>SHOW CREATE PROCEDURE</code>] para que as atualizações na fonte que causam erros sejam ignoradas e as atualizações que não causam erros sejam replicadas para a replica.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-limitations-pit-recovery"></a><a name="id380753"></a><p><b>A.4.27.</b></p></td><td align="left" valign="top"><p>As limitações anteriores afetam a capacidade do MySQL de realizar a recuperação em um ponto no tempo?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>As mesmas limitações que afetam a replicação também afetam a recuperação em um ponto no tempo.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="faq-mysql-when-limitations-resolved"></a><a name="id380758"></a><p><b>A.4.28.</b></p></td><td align="left" valign="top"><p>O que está sendo feito para corrigir as limitações mencionadas anteriormente?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Você pode escolher entre a replicação baseada em declarações ou a replicação baseada em linhas. A implementação original de replicação é baseada em registro binário baseado em declarações. O registro binário baseado em linhas resolve as limitações mencionadas anteriormente.</p><p> <span class="firstterm">Misto</span>A replicação também está disponível (iniciando o servidor com<a class="link" href="replication-options-binary-log.html#sysvar_binlog_format">[[<code>ROUTINES</code><code>mysql</code>]</a>). Essa forma híbrida de replicação<span class="quote">“<span class="quote">sabe</span>”</span>se a replicação de nível de declaração pode ser usada com segurança ou se é necessária a replicação de nível de linha.</p><p>Para obter informações adicionais, consulte<a class="xref" href="replication-formats.html" title="16.2.1 Formas de replicação">Seção 16.2.1, “Formatos de Replicação”</a>.</p></td></tr></tbody></table>
