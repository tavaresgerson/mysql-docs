#### 14.6.2.2 A Estrutura Física de um Index InnoDB

Com exceção dos *spatial indexes*, os *indexes* do `InnoDB` são estruturas de dados B-tree. Os *spatial indexes* usam R-trees, que são estruturas de dados especializadas para indexar dados multi-dimensionais. Os registros do Index são armazenados nas páginas folha (*leaf pages*) de sua estrutura de dados B-tree ou R-tree. O tamanho padrão de uma *index page* é 16KB. O tamanho da *page* é determinado pela configuração `innodb_page_size` quando a instância do MySQL é inicializada. Consulte a Seção 14.8.1, “InnoDB Startup Configuration”.

Quando novos registros são inseridos em um *clustered index* do `InnoDB`, o `InnoDB` tenta deixar 1/16 da *page* livre para futuras inserções e atualizações dos registros do Index. Se os registros do Index são inseridos em uma ordem sequencial (ascendente ou descendente), as *index pages* resultantes ficam cerca de 15/16 cheias. Se os registros são inseridos em uma ordem aleatória, as *pages* ficam de 1/2 a 15/16 cheias.

O `InnoDB` realiza um *bulk load* ao criar ou reconstruir *B-tree indexes*. Este método de criação de *index* é conhecido como *sorted index build* (construção de *index* ordenado). A variável `innodb_fill_factor` define a porcentagem de espaço em cada *B-tree page* que é preenchida durante um *sorted index build*, com o espaço restante reservado para crescimento futuro do Index. *Sorted index builds* não são suportados para *spatial indexes*. Para mais informações, consulte a Seção 14.6.2.3, “Sorted Index Builds”. Uma configuração de `innodb_fill_factor` de 100 deixa 1/16 do espaço nas *clustered index pages* livre para crescimento futuro do Index.

Se o *fill factor* de uma *index page* do `InnoDB` cair abaixo do `MERGE_THRESHOLD`, que é 50% por padrão se não for especificado, o `InnoDB` tenta contrair a *index tree* para liberar a *page*. A configuração `MERGE_THRESHOLD` se aplica tanto a *B-tree* quanto a *R-tree indexes*. Para mais informações, consulte a Seção 14.8.12, “Configuring the Merge Threshold for Index Pages”.