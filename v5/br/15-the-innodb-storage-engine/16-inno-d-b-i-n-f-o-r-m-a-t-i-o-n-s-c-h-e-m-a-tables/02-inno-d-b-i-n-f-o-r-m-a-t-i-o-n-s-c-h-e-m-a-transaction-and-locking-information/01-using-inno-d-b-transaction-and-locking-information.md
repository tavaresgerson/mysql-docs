#### 14.16.2.1 Usando Informações de Transação e Bloqueio do InnoDB

##### Identificar transações bloqueadas

Às vezes, é útil identificar qual transação está bloqueando outra. As tabelas que contêm informações sobre transações e bloqueios de dados do `InnoDB` permitem determinar qual transação está esperando por outra e qual recurso está sendo solicitado. (Para descrições dessas tabelas, consulte a Seção 14.16.2, “Informações de Transações e Bloqueios do InnoDB do Schema de Informações”).

Suponha que três sessões estejam em execução simultaneamente. Cada sessão corresponde a um fio MySQL e executa uma transação após a outra. Considere o estado do sistema quando essas sessões emitiram as seguintes instruções, mas nenhuma ainda comprometeu sua transação:

- Sessão A:

  ```sql
  BEGIN;
  SELECT a FROM t FOR UPDATE;
  SELECT SLEEP(100);
  ```

- Sessão B:

  ```sql
  SELECT b FROM t FOR UPDATE;
  ```

- Sessão C:

  ```sql
  SELECT c FROM t FOR UPDATE;
  ```

Nesse cenário, use a seguinte consulta para ver quais transações estão aguardando e quais as estão bloqueando:

```sql
SELECT
  r.trx_id waiting_trx_id,
  r.trx_mysql_thread_id waiting_thread,
  r.trx_query waiting_query,
  b.trx_id blocking_trx_id,
  b.trx_mysql_thread_id blocking_thread,
  b.trx_query blocking_query
FROM       information_schema.innodb_lock_waits w
INNER JOIN information_schema.innodb_trx b
  ON b.trx_id = w.blocking_trx_id
INNER JOIN information_schema.innodb_trx r
  ON r.trx_id = w.requesting_trx_id;
```

Ou, de forma mais simples, use a visão `sys` do esquema `innodb_lock_waits`:

```sql
SELECT
  waiting_trx_id,
  waiting_pid,
  waiting_query,
  blocking_trx_id,
  blocking_pid,
  blocking_query
FROM sys.innodb_lock_waits;
```

Se um valor NULL for reportado para a consulta de bloqueio, consulte Identificando uma consulta de bloqueio após a sessão de emissão ficar inativa.

<table summary="O conjunto de resultados de uma consulta nas tabelas INFORMATION_SCHEMA.INNODB_LOCK_WAITS e INFORMATION_SCHEMA.INNODB_TRX, mostrada no texto anterior, indica quais threads do InnoDB estão esperando por quais outras threads."><col style="width: 9%"/><col style="width: 9%"/><col style="width: 33%"/><col style="width: 10%"/><col style="width: 10%"/><col style="width: 33%"/><thead><tr> <th scope="col">id de espera trx</th> <th scope="col">fila de espera</th> <th scope="col">consulta de espera</th> <th scope="col">bloquear o ID trx</th> <th scope="col">fio de bloqueio</th> <th scope="col">bloquear consulta</th> </tr></thead><tbody><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">5</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">5</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">A5</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">7</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">SELECT c FROM t FOR UPDATE</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">A4</code>]</td> </tr><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">6</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">SELECT b FROM t FOR UPDATE</code>]</td> <td>[[<code class="literal">SELECT c FROM t FOR UPDATE</code>]]</td> <td>[[<code class="literal">A3</code>]]</td> <td>[[<code class="literal">5</code>]]</td> <td>[[<code class="literal">6</code><code class="literal">5</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">A5</code>]]</th> <td>[[<code class="literal">7</code>]]</td> <td>[[<code class="literal">SELECT c FROM t FOR UPDATE</code>]]</td> <td>[[<code class="literal">A4</code>]]</td> <td>[[<code class="literal">6</code>]]</td> <td>[[<code class="literal">SELECT b FROM t FOR UPDATE</code>]]</td> </tr></tbody></table>

Na tabela anterior, você pode identificar as sessões pelas colunas “consulta de espera” ou “consulta bloqueada”. Como você pode ver:

- A sessão B (id de transação `A4`, fio `6`) e a sessão C (id de transação `A5`, fio `7`) estão ambas aguardando a sessão A (id de transação `A3`, fio `5`).

- A sessão C está esperando a sessão B, assim como a sessão A.

Você pode ver os dados subjacentes nas tabelas `INNODB_TRX`, `INNODB_LOCKS` e `INNODB_LOCK_WAITS`.

A tabela a seguir mostra alguns conteúdos de amostra da tabela do esquema de informações `INNODB_TRX`.

<table summary="Dados de amostra da tabela INFORMATION_SCHEMA.INNODB_TRX, mostrando os tipos típicos de entradas para cada coluna."><col style="width: 10%"/><col style="width: 13%"/><col style="width: 36%"/><col style="width: 30%"/><col style="width: 36%"/><col style="width: 19%"/><col style="width: 23%"/><col style="width: 45%"/><thead><tr> <th scope="col">trx id</th> <th scope="col">trx estado</th> <th scope="col">trx começou</th> <th scope="col">trx solicitou o ID de bloqueio</th> <th scope="col">trx wait começou</th> <th scope="col">peso trx</th> <th scope="col">trx mysql thread id</th> <th scope="col">consulta trx</th> </tr></thead><tbody><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">2008-01-15 16:45:09</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">2008-01-15 16:45:09</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">2008-01-15 16:45:09</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">2</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">6</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">SELECT b FROM t FOR UPDATE</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">A5</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">LOCK WAIT</code>]</td> </tr><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">2008-01-15 16:45:14</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">A5:1:3:2</code>]</td> <td>[[<code class="literal">2008-01-15 16:45:09</code>]]</td> <td>[[<code class="literal">RUN­NING</code><code class="literal">2008-01-15 16:45:09</code>]</td> <td>[[<code class="literal">2008-01-15 16:45:09</code>]]</td> <td>[[<code class="literal">2</code>]]</td> <td>[[<code class="literal">6</code>]]</td> <td>[[<code class="literal">SELECT b FROM t FOR UPDATE</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">A5</code>]]</th> <td>[[<code class="literal">LOCK WAIT</code>]]</td> <td>[[<code class="literal">2008-01-15 16:45:14</code>]]</td> <td>[[<code class="literal">A5:1:3:2</code>]]</td> <td>[[<code class="literal">2008-01-15 16:44:54</code><code class="literal">2008-01-15 16:45:09</code>]</td> <td>[[<code class="literal">2008-01-15 16:44:54</code><code class="literal">2008-01-15 16:45:09</code>]</td> <td>[[<code class="literal">2008-01-15 16:44:54</code><code class="literal">2008-01-15 16:45:09</code>]</td> <td>[[<code class="literal">2008-01-15 16:44:54</code><code class="literal">2</code>]</td> </tr></tbody></table>

A tabela a seguir mostra alguns conteúdos de amostra da tabela do esquema de informações `INNODB_LOCKS`.

<table summary="Dados de amostra da tabela INFORMATION_SCHEMA.INNODB_LOCKS, mostrando os tipos típicos de entradas para cada coluna."><col style="width: 26%"/><col style="width: 13%"/><col style="width: 14%"/><col style="width: 21%"/><col style="width: 31%"/><col style="width: 29%"/><col style="width: 20%"/><thead><tr> <th scope="col">chave de identificação</th> <th scope="col">chave trx id</th> <th scope="col">modo de bloqueio</th> <th scope="col">tipo de trava</th> <th scope="col">trancar a tabela</th> <th scope="col">índice de bloqueio</th> <th scope="col">bloquear dados</th> </tr></thead><tbody><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">RECORD</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">RECORD</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">PRIMARY</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">0x0200</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">A5:1:3:2</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">A5</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">X</code>]</td> </tr><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">RECORD</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">test.t</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">PRIMARY</code>]</td> <td>[[<code class="literal">RECORD</code>]]</td> <td>[[<code class="literal">A3</code><code class="literal">RECORD</code>]</td> <td>[[<code class="literal">PRIMARY</code>]]</td> <td>[[<code class="literal">0x0200</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">A5:1:3:2</code>]]</th> <td>[[<code class="literal">A5</code>]]</td> <td>[[<code class="literal">X</code>]]</td> <td>[[<code class="literal">RECORD</code>]]</td> <td>[[<code class="literal">test.t</code>]]</td> <td>[[<code class="literal">PRIMARY</code>]]</td> <td>[[<code class="literal">X</code><code class="literal">RECORD</code>]</td> </tr></tbody></table>

A tabela a seguir mostra alguns conteúdos de amostra da tabela do esquema de informações `INNODB_LOCK_WAITS`.

<table summary="Dados de amostra da tabela INFORMATION_SCHEMA.INNODB_LOCK_WAITS, mostrando os tipos típicos de entradas para cada coluna."><col style="width: 10%"/><col style="width: 15%"/><col style="width: 10%"/><col style="width: 15%"/><thead><tr> <th scope="col">solicitando ID trx</th> <th scope="col">ID de bloqueio solicitado</th> <th scope="col">bloquear o ID trx</th> <th scope="col">bloqueio de identificação de bloqueio</th> </tr></thead><tbody><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">A4</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">A4</code>]</td> <td>[[<code class="literal">A3</code>]]</td> <td>[[<code class="literal">A3:1:3:2</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">A5</code>]]</th> <td>[[<code class="literal">A5:1:3:2</code>]]</td> <td>[[<code class="literal">A3</code>]]</td> <td>[[<code class="literal">A3:1:3:2</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">A5</code>]]</th> <td>[[<code class="literal">A5:1:3:2</code>]]</td> <td>[[<code class="literal">A4</code>]]</td> <td>[[<code class="literal">A4:1:3:2</code><code class="literal">A4</code>]</td> </tr></tbody></table>

##### Identificando uma consulta bloqueada após a sessão de emissão ficar inativa

Ao identificar transações bloqueadas, um valor NULL é reportado para a consulta de bloqueio se a sessão que emitiu a consulta se tornar inativa. Nesse caso, siga os passos abaixo para determinar a consulta de bloqueio:

1. Identifique o ID do processo da transação que está bloqueando. Na tabela `sys.innodb_lock_waits`, o ID do processo da transação que está bloqueando é o valor `blocking_pid`.

2. Usando `blocking_pid`, consulte a tabela `threads` do Schema de Desempenho do MySQL para determinar o `THREAD_ID` da transação bloqueada. Por exemplo, se `blocking_pid` for 6, execute esta consulta:

   ```sql
   SELECT THREAD_ID FROM performance_schema.threads WHERE PROCESSLIST_ID = 6;
   ```

3. Usando o `THREAD_ID`, consulte a tabela `events_statements_current` do Schema de Desempenho para determinar a última consulta executada pelo thread. Por exemplo, se o `THREAD_ID` for 28, execute esta consulta:

   ```sql
   SELECT THREAD_ID, SQL_TEXT FROM performance_schema.events_statements_current
   WHERE THREAD_ID = 28\G
   ```

4. Se a última consulta executada pelo thread não for suficiente para determinar por que um bloqueio está sendo mantido, você pode consultar a tabela `events_statements_history` do Gerenciamento de Desempenho para visualizar as últimas 10 instruções executadas pelo thread.

   ```sql
   SELECT THREAD_ID, SQL_TEXT FROM performance_schema.events_statements_history
   WHERE THREAD_ID = 28 ORDER BY EVENT_ID;
   ```

##### Correlação de Transações InnoDB com Sessões do MySQL

Às vezes, é útil correlacionar as informações de bloqueio do `InnoDB` interno com as informações de nível de sessão mantidas pelo MySQL. Por exemplo, você pode querer saber, para um ID de transação `InnoDB` específico, o ID de sessão MySQL correspondente e o nome da sessão que pode estar segurando um bloqueio, e assim bloqueando outras transações.

O seguinte resultado das tabelas `INFORMATION_SCHEMA` é obtido de um sistema um pouco sobrecarregado. Como pode ser visto, há várias transações em execução.

As tabelas `INNODB_LOCKS` e `INNODB_LOCK_WAITS` a seguir mostram que:

- A transação `77F` (que executa um `INSERT`) está aguardando o commit das transações `77E`, `77D` e `77B`.

- A transação `77E` (executando uma `INSERT`) está aguardando a conclusão das transações `77D` e `77B`.

- A transação `77D` (executando uma `INSERT`) está aguardando o commit da transação `77B`.

- A transação `77B` (executando uma `INSERT`) está aguardando o commit da transação `77A`.

- A transação `77A` está em execução, atualmente executando `SELECT`.

- A transação `E56` (executando uma `INSERT`) está aguardando o commit da transação `E55`.

- A transação `E55` (executando uma `INSERT`) está aguardando o commit da transação `19C`.

- A transação `19C` está em execução, atualmente executando uma `INSERT`.

Nota

Pode haver inconsistências entre as consultas exibidas nas tabelas `INFORMATION_SCHEMA` `PROCESSLIST` e `INNODB_TRX`. Para uma explicação, consulte a Seção 14.16.2.3, “Persistência e Consistência das Informações de Transação e Bloqueio do InnoDB”.

A tabela a seguir mostra o conteúdo da tabela do esquema de informações `PROCESSLIST` para um sistema que executa uma carga de trabalho pesada.

<table summary="Dados de amostra da tabela INFORMATION_SCHEMA.PROCESSLIST, mostrando o funcionamento interno dos processos do MySQL sob uma carga de trabalho intensa."><col style="width: 8%"/><col style="width: 11%"/><col style="width: 21%"/><col style="width: 10%"/><col style="width: 20%"/><col style="width: 10%"/><col style="width: 20%"/><col style="width: 25%"/><thead><tr> <th scope="col">ID</th> <th scope="col">USUÁRIO</th> <th scope="col">ANfitrião</th> <th scope="col">DB</th> <th scope="col">COMANDO</th> <th scope="col">TIME</th> <th scope="col">ESTADO</th> <th scope="col">INFORMAÇÕES</th> </tr></thead><tbody><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">localhost</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">localhost</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">Query</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">3</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">update</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">INSERT INTO t2 VALUES …</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">130</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">root</code>]</td> </tr><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">localhost</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">test</code>]</td> <td>[[<code class="literal">localhost</code>]]</td> <td>[[<code class="literal">root</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">Query</code>]]</td> <td>[[<code class="literal">3</code>]]</td> <td>[[<code class="literal">update</code>]]</td> <td>[[<code class="literal">INSERT INTO t2 VALUES …</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">130</code>]]</th> <td>[[<code class="literal">root</code>]]</td> <td>[[<code class="literal">localhost</code>]]</td> <td>[[<code class="literal">test</code>]]</td> <td>[[<code class="literal">localhost</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">localhost</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">localhost</code><code class="literal">Query</code>]</td> <td>[[<code class="literal">localhost</code><code class="literal">3</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">localhost</code><code class="literal">update</code>]</th> <td>[[<code class="literal">localhost</code><code class="literal">INSERT INTO t2 VALUES …</code>]</td> <td>[[<code class="literal">localhost</code><code class="literal">130</code>]</td> <td>[[<code class="literal">localhost</code><code class="literal">root</code>]</td> <td>[[<code class="literal">localhost</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">localhost</code><code class="literal">test</code>]</td> <td>[[<code class="literal">test</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">test</code><code class="literal">localhost</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">test</code><code class="literal">Query</code>]</th> <td>[[<code class="literal">test</code><code class="literal">3</code>]</td> <td>[[<code class="literal">test</code><code class="literal">update</code>]</td> <td>[[<code class="literal">test</code><code class="literal">INSERT INTO t2 VALUES …</code>]</td> <td>[[<code class="literal">test</code><code class="literal">130</code>]</td> <td>[[<code class="literal">test</code><code class="literal">root</code>]</td> <td>[[<code class="literal">test</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">test</code><code class="literal">test</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">Query</code><code class="literal">localhost</code>]</th> <td>[[<code class="literal">Query</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">Query</code><code class="literal">Query</code>]</td> <td>[[<code class="literal">Query</code><code class="literal">3</code>]</td> <td>[[<code class="literal">Query</code><code class="literal">update</code>]</td> <td>[[<code class="literal">Query</code><code class="literal">INSERT INTO t2 VALUES …</code>]</td> <td>[[<code class="literal">Query</code><code class="literal">130</code>]</td> <td>[[<code class="literal">Query</code><code class="literal">root</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">Query</code><code class="literal">localhost</code>]</th> <td>[[<code class="literal">Query</code><code class="literal">test</code>]</td> <td>[[<code class="literal">10</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">10</code><code class="literal">localhost</code>]</td> <td>[[<code class="literal">10</code><code class="literal">Query</code>]</td> <td>[[<code class="literal">10</code><code class="literal">3</code>]</td> <td>[[<code class="literal">10</code><code class="literal">update</code>]</td> <td>[[<code class="literal">10</code><code class="literal">INSERT INTO t2 VALUES …</code>]</td> </tr></tbody></table>

A tabela a seguir mostra o conteúdo da tabela do esquema de informações `INNODB_TRX` para um sistema que executa uma carga de trabalho pesada.

<table summary="Dados de amostra da tabela INFORMATION_SCHEMA.INNODB_TRX, mostrando o funcionamento interno das transações do InnoDB sob uma carga de trabalho pesada."><col style="width: 8%"/><col style="width: 10%"/><col style="width: 19%"/><col style="width: 21%"/><col style="width: 19%"/><col style="width: 10%"/><col style="width: 10%"/><col style="width: 31%"/><thead><tr> <th scope="col">trx id</th> <th scope="col">trx estado</th> <th scope="col">trx começou</th> <th scope="col">trx solicitou o ID de bloqueio</th> <th scope="col">trx wait começou</th> <th scope="col">peso trx</th> <th scope="col">trx mysql thread id</th> <th scope="col">consulta trx</th> </tr></thead><tbody><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">2008-01-15 13:10:16</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">1</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">875</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">77D</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">LOCK WAIT</code>]</td> </tr><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">2008-01-15 13:10:16</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">77D</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code>]]</td> <td>[[<code class="literal">LOCK WAIT</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code>]]</td> <td>[[<code class="literal">1</code>]]</td> <td>[[<code class="literal">875</code>]]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">77D</code>]]</th> <td>[[<code class="literal">LOCK WAIT</code>]]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code>]]</td> <td>[[<code class="literal">77D</code>]]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">1</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">875</code>]</th> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">LOCK WAIT</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">77F</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">77F</code><code class="literal">2008-01-15 13:10:16</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">77F</code><code class="literal">2008-01-15 13:10:16</code>]</th> <td>[[<code class="literal">77F</code><code class="literal">1</code>]</td> <td>[[<code class="literal">77F</code><code class="literal">875</code>]</td> <td>[[<code class="literal">77F</code><code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code>]</td> <td>[[<code class="literal">77F</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">77F</code><code class="literal">LOCK WAIT</code>]</td> <td>[[<code class="literal">77F</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">77F</code><code class="literal">77D</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">2008-01-15 13:10:16</code>]</th> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">1</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">875</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">LOCK WAIT</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">2008-01-15 13:10:16</code>]</th> <td>[[<code class="literal">2008-01-15 13:10:16</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">1</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">1</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">1</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">1</code><code class="literal">1</code>]</td> <td>[[<code class="literal">1</code><code class="literal">875</code>]</td> <td>[[<code class="literal">1</code><code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">1</code><code class="literal">77D</code>]</th> <td>[[<code class="literal">1</code><code class="literal">LOCK WAIT</code>]</td> <td>[[<code class="literal">1</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">1</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">876</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">876</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">876</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">876</code><code class="literal">1</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">876</code><code class="literal">875</code>]</th> <td>[[<code class="literal">876</code><code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code>]</td> <td>[[<code class="literal">876</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">876</code><code class="literal">LOCK WAIT</code>]</td> <td>[[<code class="literal">876</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">876</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">2008-01-15 13:10:16</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">2008-01-15 13:10:16</code>]</th> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">1</code>]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">875</code>]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code>]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">LOCK WAIT</code>]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">2008-01-15 13:10:16</code>]</td> <td>[[<code class="literal">INSERT INTO t09 (D, B, C) VALUES …</code><code class="literal">77D</code>]</td> </tr></tbody></table>

A tabela a seguir mostra o conteúdo da tabela do esquema de informações `INNODB_LOCK_WAITS` para um sistema que executa uma carga de trabalho pesada.

<table summary="Dados de amostra da tabela INFORMATION_SCHEMA.INNODB_LOCK_WAITS, mostrando o funcionamento interno do bloqueio do InnoDB sob uma carga de trabalho pesada."><col style="width: 25%"/><col style="width: 25%"/><col style="width: 25%"/><col style="width: 25%"/><thead><tr> <th scope="col">solicitando ID trx</th> <th scope="col">ID de bloqueio solicitado</th> <th scope="col">bloquear o ID trx</th> <th scope="col">bloqueio de identificação de bloqueio</th> </tr></thead><tbody><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">77B</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">77B</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">77E</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">77E:806</code>]</td> </tr><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">77D</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">77D:806</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">77E</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">77E:806</code>]</td> </tr><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">77B</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">77B:806</code>]</td> <td>[[<code class="literal">77B</code>]]</td> <td>[[<code class="literal">77F:806</code><code class="literal">77B</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">77E</code>]]</th> <td>[[<code class="literal">77E:806</code>]]</td> <td>[[<code class="literal">77D</code>]]</td> <td>[[<code class="literal">77D:806</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">77E</code>]]</th> <td>[[<code class="literal">77E:806</code>]]</td> <td>[[<code class="literal">77B</code>]]</td> <td>[[<code class="literal">77B:806</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">77E</code><code class="literal">77B</code>]</th> <td>[[<code class="literal">77E</code><code class="literal">77B</code>]</td> <td>[[<code class="literal">77E</code><code class="literal">77E</code>]</td> <td>[[<code class="literal">77E</code><code class="literal">77E:806</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">77E</code><code class="literal">77D</code>]</th> <td>[[<code class="literal">77E</code><code class="literal">77D:806</code>]</td> <td>[[<code class="literal">77E</code><code class="literal">77E</code>]</td> <td>[[<code class="literal">77E</code><code class="literal">77E:806</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">77E</code><code class="literal">77B</code>]</th> <td>[[<code class="literal">77E</code><code class="literal">77B:806</code>]</td> <td>[[<code class="literal">77E:806</code><code class="literal">77B</code>]</td> <td>[[<code class="literal">77E:806</code><code class="literal">77B</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">77E:806</code><code class="literal">77E</code>]</th> <td>[[<code class="literal">77E:806</code><code class="literal">77E:806</code>]</td> <td>[[<code class="literal">77E:806</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">77E:806</code><code class="literal">77D:806</code>]</td> </tr></tbody></table>

A tabela a seguir mostra o conteúdo da tabela do esquema de informações `INNODB_LOCKS` para um sistema que executa uma carga de trabalho pesada.

<table summary="Dados de amostra da tabela INFORMATION_SCHEMA.INNODB_LOCKS, mostrando o funcionamento interno do bloqueio do InnoDB sob uma carga de trabalho pesada."><col style="width: 18%"/><col style="width: 9%"/><col style="width: 12%"/><col style="width: 12%"/><col style="width: 14%"/><col style="width: 17%"/><col style="width: 17%"/><thead><tr> <th scope="col">chave de identificação</th> <th scope="col">chave trx id</th> <th scope="col">modo de bloqueio</th> <th scope="col">tipo de trava</th> <th scope="col">trancar a tabela</th> <th scope="col">índice de bloqueio</th> <th scope="col">bloquear dados</th> </tr></thead><tbody><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">TABLE</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">TABLE</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">NULL</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">NULL</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">77D:806</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">77D</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">AUTO_INC</code>]</td> </tr><tr> <th scope="row">[[PH_HTML_CODE_<code class="literal">TABLE</code>]</th> <td>[[PH_HTML_CODE_<code class="literal">test.t09</code>]</td> <td>[[PH_HTML_CODE_<code class="literal">NULL</code>]</td> <td>[[<code class="literal">TABLE</code>]]</td> <td>[[<code class="literal">77F</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">NULL</code>]]</td> <td>[[<code class="literal">NULL</code>]]</td> </tr><tr> <th scope="row">[[<code class="literal">77D:806</code>]]</th> <td>[[<code class="literal">77D</code>]]</td> <td>[[<code class="literal">AUTO_INC</code>]]</td> <td>[[<code class="literal">TABLE</code>]]</td> <td>[[<code class="literal">test.t09</code>]]</td> <td>[[<code class="literal">NULL</code>]]</td> <td>[[<code class="literal">AUTO_INC</code><code class="literal">TABLE</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">AUTO_INC</code><code class="literal">TABLE</code>]</th> <td>[[<code class="literal">AUTO_INC</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">AUTO_INC</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">AUTO_INC</code><code class="literal">77D:806</code>]</td> <td>[[<code class="literal">AUTO_INC</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">AUTO_INC</code><code class="literal">AUTO_INC</code>]</td> <td>[[<code class="literal">AUTO_INC</code><code class="literal">TABLE</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">AUTO_INC</code><code class="literal">test.t09</code>]</th> <td>[[<code class="literal">AUTO_INC</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">TABLE</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">TABLE</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">TABLE</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">TABLE</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">TABLE</code><code class="literal">77D:806</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">TABLE</code><code class="literal">77D</code>]</th> <td>[[<code class="literal">TABLE</code><code class="literal">AUTO_INC</code>]</td> <td>[[<code class="literal">TABLE</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">TABLE</code><code class="literal">test.t09</code>]</td> <td>[[<code class="literal">TABLE</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">test.t09</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">test.t09</code><code class="literal">TABLE</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">test.t09</code><code class="literal">NULL</code>]</th> <td>[[<code class="literal">test.t09</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">test.t09</code><code class="literal">77D:806</code>]</td> <td>[[<code class="literal">test.t09</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">test.t09</code><code class="literal">AUTO_INC</code>]</td> <td>[[<code class="literal">test.t09</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">test.t09</code><code class="literal">test.t09</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">test.t09</code><code class="literal">NULL</code>]</th> <td>[[<code class="literal">NULL</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">77D:806</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">77D</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">NULL</code><code class="literal">AUTO_INC</code>]</th> <td>[[<code class="literal">NULL</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">test.t09</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">NULL</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">NULL</code>]</td> </tr><tr> <th scope="row">[[<code class="literal">NULL</code><code class="literal">NULL</code>]</th> <td>[[<code class="literal">NULL</code><code class="literal">77D:806</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">77D</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">AUTO_INC</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">TABLE</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">test.t09</code>]</td> <td>[[<code class="literal">NULL</code><code class="literal">NULL</code>]</td> </tr></tbody></table>
