### 6.1.3 Tornando o MySQL Seguro Contra Atacantes

Ao se conectar a um MySQL server, você deve usar uma password. A password não é transmitida como cleartext (texto simples) pela conexão. O tratamento de passwords durante a sequência de conexão do client foi atualizado no MySQL 4.1.1 para ser muito seguro. Se você ainda estiver usando passwords no estilo pré-4.1.1, o algoritmo de criptografia não é tão forte quanto o algoritmo mais recente. Com algum esforço, um atacante inteligente que consiga 'sniffar' (farejar) o tráfego entre o client e o server pode quebrar a password. (Consulte [Section 6.1.2.4, “Password Hashing in MySQL”](password-hashing.html "6.1.2.4 Password Hashing in MySQL"), para uma discussão sobre os diferentes métodos de tratamento de passwords.)

Todas as outras informações são transferidas como texto e podem ser lidas por qualquer pessoa capaz de observar a conexão. Se a conexão entre o client e o server passar por uma rede não confiável, e isso for uma preocupação, você pode usar o compressed protocol (protocolo compactado) para tornar o tráfego muito mais difícil de decifrar. Você também pode usar o suporte SSL interno do MySQL para tornar a conexão ainda mais segura. Consulte [Section 6.3, “Using Encrypted Connections”](encrypted-connections.html "6.3 Using Encrypted Connections"). Alternativamente, use SSH para obter uma conexão TCP/IP criptografada entre um MySQL server e um MySQL client. Você pode encontrar um SSH client Open Source em <http://www.openssh.org/>, e uma comparação de SSH clients Open Source e Comerciais em <http://en.wikipedia.org/wiki/Comparison_of_SSH_clients>.

Para tornar um sistema MySQL seguro, você deve considerar seriamente as seguintes sugestões:

* Exija que todas as contas MySQL tenham uma password. Um client program não sabe necessariamente a identidade da pessoa que o está executando. É comum em aplicações client/server que o user possa especificar qualquer user name para o client program. Por exemplo, qualquer pessoa pode usar o programa [**mysql**](mysql.html "4.5.1 mysql — The MySQL Command-Line Client") para se conectar como qualquer outra pessoa simplesmente invocando-o como `mysql -u other_user db_name` se *`other_user`* não tiver uma password. Se todas as contas tiverem uma password, conectar-se usando a conta de outro user se torna muito mais difícil.

  Para uma discussão sobre métodos para definir passwords, consulte [Section 6.2.10, “Assigning Account Passwords”](assigning-passwords.html "6.2.10 Assigning Account Passwords").

* Certifique-se de que a única conta de user Unix com privilégios de read ou write nos diretórios do Database seja a conta usada para executar [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server").

* Nunca execute o MySQL server como o user Unix `root`. Isso é extremamente perigoso, porque qualquer user com o privilégio [`FILE`](privileges-provided.html#priv_file) é capaz de fazer com que o server crie arquivos como `root` (por exemplo, `~root/.bashrc`). Para evitar isso, [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") recusa-se a ser executado como `root`, a menos que isso seja especificado explicitamente usando a opção [`--user=root`](server-options.html#option_mysqld_user).

  [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") pode (e deve) ser executado como um user comum, sem privilégios. Você pode criar uma conta Unix separada chamada `mysql` para tornar tudo ainda mais seguro. Use esta conta apenas para administrar o MySQL. Para iniciar [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") como um user Unix diferente, adicione uma opção `user` que especifique o user name no grupo `[mysqld]` do arquivo de opções `my.cnf`, onde você especifica as opções do server. Por exemplo:

  ```sql
  [mysqld]
  user=mysql
  ```

  Isso faz com que o server inicie como o user designado, seja iniciando-o manualmente ou usando [**mysqld_safe**](mysqld-safe.html "4.3.2 mysqld_safe — MySQL Server Startup Script") ou [**mysql.server**](mysql-server.html "4.3.3 mysql.server — MySQL Server Startup Script"). Para mais detalhes, consulte [Section 6.1.5, “How to Run MySQL as a Normal User”](changing-mysql-user.html "6.1.5 How to Run MySQL as a Normal User").

  Executar [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") como um user Unix diferente de `root` não significa que você precise alterar o user name `root` na tabela `user`. *User names para contas MySQL não têm relação com user names para contas Unix*.

* Não conceda o privilégio [`FILE`](privileges-provided.html#priv_file) a users não administrativos. Qualquer user que tenha este privilégio pode gravar um arquivo em qualquer lugar no file system com os privilégios do daemon [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server"). Isso inclui o data directory do server, contendo os arquivos que implementam as privilege tables. Para tornar as operações de privilégio [`FILE`](privileges-provided.html#priv_file) um pouco mais seguras, arquivos gerados com [`SELECT ... INTO OUTFILE`](select-into.html "13.2.9.1 SELECT ... INTO Statement") não sobrescrevem arquivos existentes e são graváveis por todos.

  O privilégio [`FILE`](privileges-provided.html#priv_file) também pode ser usado para ler qualquer arquivo que seja de leitura universal (world-readable) ou acessível ao user Unix sob o qual o server é executado. Com este privilégio, você pode ler qualquer arquivo para dentro de uma database table. Isso pode ser abusado, por exemplo, usando [`LOAD DATA`](load-data.html "13.2.6 LOAD DATA Statement") para carregar `/etc/passwd` em uma table, que pode então ser exibida com [`SELECT`](select.html "13.2.9 SELECT Statement").

  Para limitar o local onde os arquivos podem ser lidos e gravados, defina o sistema [`secure_file_priv`](server-system-variables.html#sysvar_secure_file_priv) para um diretório específico. Consulte [Section 5.1.7, “Server System Variables”](server-system-variables.html "5.1.7 Server System Variables").

* Não conceda o privilégio [`PROCESS`](privileges-provided.html#priv_process) ou [`SUPER`](privileges-provided.html#priv_super) a users não administrativos. A saída de [**mysqladmin processlist**](mysqladmin.html "4.5.2 mysqladmin — A MySQL Server Administration Program") e [`SHOW PROCESSLIST`](show-processlist.html "13.7.5.29 SHOW PROCESSLIST Statement") mostra o texto de quaisquer statements atualmente em execução, de modo que qualquer user que tenha permissão para ver a process list do server possa ver statements emitidos por outros users, como `UPDATE user SET password=PASSWORD('not_secure')`.

  [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") reserva uma conexão extra para users que possuem o privilégio [`SUPER`](privileges-provided.html#priv_super), para que um user `root` do MySQL possa fazer login e verificar a atividade do server mesmo que todas as conexões normais estejam em uso.

  O privilégio [`SUPER`](privileges-provided.html#priv_super) pode ser usado para encerrar conexões client, alterar a operação do server mudando o valor de system variables e controlar replication servers.

* Não permita o uso de symlinks (links simbólicos) para tables. (Essa capacidade pode ser desabilitada com a opção [`--skip-symbolic-links`](server-options.html#option_mysqld_symbolic-links).) Isso é especialmente importante se você executar [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") como `root`, porque qualquer pessoa que tenha acesso de write ao data directory do server poderia então deletar qualquer arquivo no sistema! Consulte [Section 8.12.3.2, “Using Symbolic Links for MyISAM Tables on Unix”](symbolic-links-to-tables.html "8.12.3.2 Using Symbolic Links for MyISAM Tables on Unix").

* Stored programs (programas armazenados) e views devem ser escritos usando as diretrizes de segurança discutidas em [Section 23.6, “Stored Object Access Control”](stored-objects-security.html "23.6 Stored Object Access Control").

* Se você não confia no seu DNS, você deve usar IP addresses em vez de host names nas grant tables. Em qualquer caso, você deve ser muito cuidadoso ao criar entradas na grant table usando valores de host name que contenham wildcards.

* Se você quiser restringir o número de conexões permitidas para uma única conta, você pode fazer isso configurando a variável [`max_user_connections`](server-system-variables.html#sysvar_max_user_connections) em [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server"). Os statements [`CREATE USER`](create-user.html "13.7.1.2 CREATE USER Statement") e [`ALTER USER`](alter-user.html "13.7.1.1 ALTER USER Statement") também suportam opções de resource control para limitar a extensão do uso do server permitido a uma conta. Consulte [Section 13.7.1.2, “CREATE USER Statement”](create-user.html "13.7.1.2 CREATE USER Statement") e [Section 13.7.1.1, “ALTER USER Statement”](alter-user.html "13.7.1.1 ALTER USER Statement").

* Se o plugin directory for gravável pelo server, pode ser possível para um user escrever código executável em um arquivo no diretório usando [`SELECT ... INTO DUMPFILE`](select.html "13.2.9 SELECT Statement"). Isso pode ser evitado tornando [`plugin_dir`](server-system-variables.html#sysvar_plugin_dir) read only para o server ou definindo [`secure_file_priv`](server-system-variables.html#sysvar_secure_file_priv) para um diretório onde operações de write de [`SELECT`](select.html "13.2.9 SELECT Statement") possam ser feitas com segurança.