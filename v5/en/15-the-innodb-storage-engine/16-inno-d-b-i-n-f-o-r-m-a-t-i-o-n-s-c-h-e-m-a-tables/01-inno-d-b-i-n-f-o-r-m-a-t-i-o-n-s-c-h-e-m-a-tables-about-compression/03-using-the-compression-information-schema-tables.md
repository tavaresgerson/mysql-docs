#### 14.16.1.3 Using the Compression Information Schema Tables

**Example 14.1 Using the Compression Information Schema Tables**

The following is sample output from a database that contains compressed tables (see Section 14.9, “InnoDB Table and Page Compression”, `INNODB_CMP`, `INNODB_CMP_PER_INDEX`, and `INNODB_CMPMEM`).

The following table shows the contents of the Information Schema `INNODB_CMP` table under a light workload. The only compressed page size that the buffer pool contains is 8K. Compressing or uncompressing pages has consumed less than a second since the time the statistics were reset, because the columns `COMPRESS_TIME` and `UNCOMPRESS_TIME` are zero.

<table summary="Sample data from the INFORMATION_SCHEMA.INNODB_CMP table, showing the internal workings of InnoDB table compression under a light workload."><col style="width: 15%"/><col style="width: 15%"/><col style="width: 15%"/><col style="width: 15%"/><col style="width: 20%"/><col style="width: 20%"/><thead><tr> <th scope="col">page size</th> <th scope="col">compress ops</th> <th scope="col">compress ops ok</th> <th scope="col">compress time</th> <th scope="col">uncompress ops</th> <th scope="col">uncompress time</th> </tr></thead><tbody><tr> <th scope="row">1024</th> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">2048</th> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">4096</th> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">8192</th> <td>1048</td> <td>921</td> <td>0</td> <td>61</td> <td>0</td> </tr><tr> <th scope="row">16384</th> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr></tbody></table>

According to `INNODB_CMPMEM`, there are 6169 compressed 8KB pages in the buffer pool. The only other allocated block size is 64 bytes. The smallest `PAGE_SIZE` in `INNODB_CMPMEM` is used for block descriptors of those compressed pages for which no uncompressed page exists in the buffer pool. We see that there are 5910 such pages. Indirectly, we see that 259 (6169-5910) compressed pages also exist in the buffer pool in uncompressed form.

The following table shows the contents of the Information Schema `INNODB_CMPMEM` table under a light workload. Some memory is unusable due to fragmentation of the memory allocator for compressed pages: `SUM(PAGE_SIZE*PAGES_FREE)=6784`. This is because small memory allocation requests are fulfilled by splitting bigger blocks, starting from the 16K blocks that are allocated from the main buffer pool, using the buddy allocation system. The fragmentation is this low because some allocated blocks have been relocated (copied) to form bigger adjacent free blocks. This copying of `SUM(PAGE_SIZE*RELOCATION_OPS)` bytes has consumed less than a second `(SUM(RELOCATION_TIME)=0)`.

<table summary="Sample data from the INFORMATION_SCHEMA.INNODB_CMPMEM table, showing buffer pool memory operations for InnoDB table compression under a light workload."><col style="width: 15%"/><col style="width: 15%"/><col style="width: 20%"/><col style="width: 20%"/><col style="width: 20%"/><thead><tr> <th scope="col">page size</th> <th scope="col">pages used</th> <th scope="col">pages free</th> <th scope="col">relocation ops</th> <th scope="col">relocation time</th> </tr></thead><tbody><tr> <th scope="row">64</th> <td>5910</td> <td>0</td> <td>2436</td> <td>0</td> </tr><tr> <th scope="row">128</th> <td>0</td> <td>1</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">256</th> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">512</th> <td>0</td> <td>1</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">1024</th> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">2048</th> <td>0</td> <td>1</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">4096</th> <td>0</td> <td>1</td> <td>0</td> <td>0</td> </tr><tr> <th scope="row">8192</th> <td>6169</td> <td>0</td> <td>5</td> <td>0</td> </tr><tr> <th scope="row">16384</th> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr></tbody></table>
