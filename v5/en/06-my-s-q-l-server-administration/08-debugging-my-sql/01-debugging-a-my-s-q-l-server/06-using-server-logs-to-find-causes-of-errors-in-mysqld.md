#### 5.8.1.6 Usando Logs do Servidor para Encontrar Causas de Erros no mysqld

Observe que antes de iniciar o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") com o general Query log habilitado, você deve verificar todas as suas tabelas usando [**myisamchk**](myisamchk.html "4.6.3 myisamchk — MyISAM Table-Maintenance Utility"). Consulte [Capítulo 5, *Administração do Servidor MySQL*](server-administration.html "Chapter 5 MySQL Server Administration").

Se o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") falhar (die) ou travar (hang), você deve iniciar o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") com o general Query log habilitado. Consulte [Seção 5.4.3, “O General Query Log”](query-log.html "5.4.3 The General Query Log"). Quando o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") falhar novamente, você pode examinar o final do arquivo de log em busca da Query que causou a falha do [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server").

Se você usar o arquivo de log padrão do general Query log, o log é armazenado no diretório do Database como `host_name.log`. Na maioria dos casos, a última Query no arquivo de log é a que causou a falha do [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server"), mas se possível, você deve verificar isso reiniciando o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") e executando a Query encontrada a partir das ferramentas de linha de comando [**mysql**](mysql.html "4.5.1 mysql — The MySQL Command-Line Client"). Se isso funcionar, você também deve testar todas as Queries complicadas que não foram concluídas.

Você também pode tentar o comando [`EXPLAIN`](explain.html "13.8.2 EXPLAIN Statement") em todas as declarações [`SELECT`](select.html "13.2.9 SELECT Statement") que levam muito tempo para garantir que o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") esteja usando Indexes adequadamente. Consulte [Seção 13.8.2, “EXPLAIN Statement”](explain.html "13.8.2 EXPLAIN Statement").

Você pode encontrar as Queries que levam muito tempo para executar iniciando o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") com o slow Query log habilitado. Consulte [Seção 5.4.5, “O Slow Query Log”](slow-query-log.html "5.4.5 The Slow Query Log").

Se você encontrar o texto `mysqld restarted` no log de erro (normalmente um arquivo chamado `host_name.err`), você provavelmente encontrou uma Query que está causando a falha do [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server"). Se isso acontecer, você deve verificar todas as suas tabelas com [**myisamchk**](myisamchk.html "4.6.3 myisamchk — MyISAM Table-Maintenance Utility") (consulte [Capítulo 5, *Administração do Servidor MySQL*](server-administration.html "Chapter 5 MySQL Server Administration")), e testar as Queries nos arquivos de log do MySQL para ver se alguma falha. Se você encontrar tal Query, tente primeiro atualizar para a versão mais recente do MySQL. Se isso não ajudar, relate um bug; consulte [Seção 1.5, “Como Relatar Bugs ou Problemas”](bug-reports.html "1.5 How to Report Bugs or Problems").

Se você iniciou o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") com a variável de sistema [`myisam_recover_options`](server-system-variables.html#sysvar_myisam_recover_options) definida, o MySQL verifica e tenta reparar automaticamente as tabelas `MyISAM` se elas estiverem marcadas como 'not closed properly' (não fechadas corretamente) ou 'crashed' (corrompidas). Se isso ocorrer, o MySQL escreve uma entrada no arquivo `hostname.err` com `'Warning: Checking table ...'`, que é seguida por `Warning: Repairing table` se a tabela precisar ser reparada. Se você receber muitos desses erros, sem que o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") tenha falhado inesperadamente pouco antes, algo está errado e precisa ser investigado mais a fundo. Consulte [Seção 5.1.6, “Opções de Comando do Servidor”](server-options.html "5.1.6 Server Command Options").

Quando o servidor detecta corrupção em tabelas `MyISAM`, ele escreve informações adicionais no log de erro, como o nome e o número da linha do arquivo fonte, e a lista de Threads acessando a tabela. Exemplo: `Got an error from thread_id=1, mi_dynrec.c:368`. Esta é uma informação útil para incluir em relatórios de bug.

Não é um bom sinal se o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") falhou inesperadamente, mas neste caso, você não deve investigar as mensagens de `Checking table...`, mas sim tentar descobrir por que o [**mysqld**](mysqld.html "4.3.1 mysqld — The MySQL Server") falhou.