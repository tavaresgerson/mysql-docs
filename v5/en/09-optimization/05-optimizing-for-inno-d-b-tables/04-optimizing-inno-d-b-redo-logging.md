### 8.5.4 Otimizando o Redo Logging do InnoDB

Considere as seguintes diretrizes para otimizar o *redo logging*:

* Torne seus arquivos de *redo log* grandes, até mesmo do tamanho do *Buffer Pool*. Quando o `InnoDB` preenche os arquivos de *redo log*, ele deve escrever o conteúdo modificado do *Buffer Pool* para o *disk* em um *checkpoint*. Arquivos de *redo log* pequenos causam muitas escritas em *disk* desnecessárias. Embora historicamente arquivos de *redo log* grandes causassem longos tempos de recuperação, a recuperação agora é muito mais rápida e você pode usar arquivos de *redo log* grandes com confiança.

  O tamanho e o número dos arquivos de *redo log* são configurados usando as opções de configuração `innodb_log_file_size` e `innodb_log_files_in_group`. Para obter informações sobre como modificar uma configuração de arquivo de *redo log* existente, consulte Alterando o Número ou Tamanho dos Arquivos de Redo Log do InnoDB.

* Considere aumentar o tamanho do *log buffer*. Um *log buffer* grande permite que transações volumosas sejam executadas sem a necessidade de escrever o log para o *disk* antes que as transações sejam commitadas. Assim, se você tiver transações que atualizam, inserem ou deletam muitas linhas, aumentar o *log buffer* economiza *Disk I/O*. O tamanho do *log buffer* é configurado usando a opção `innodb_log_buffer_size`.

* Configure a opção `innodb_log_write_ahead_size` para evitar "read-on-write". Esta opção define o tamanho do bloco *write-ahead* (escrita antecipada) para o *redo log*. Defina `innodb_log_write_ahead_size` para corresponder ao tamanho do bloco de *cache* do sistema operacional ou do sistema de arquivos. O "read-on-write" ocorre quando os blocos de *redo log* não são totalmente *cached* no sistema operacional ou sistema de arquivos devido a uma incompatibilidade entre o tamanho do bloco *write-ahead* para o *redo log* e o tamanho do bloco de *cache* do sistema operacional ou do sistema de arquivos.

  Valores válidos para `innodb_log_write_ahead_size` são múltiplos do tamanho do bloco do arquivo de *log* do `InnoDB` (2n). O valor mínimo é o tamanho do bloco do arquivo de *log* do `InnoDB` (512). O *write-ahead* não ocorre quando o valor mínimo é especificado. O valor máximo é igual ao valor de `innodb_page_size`. Se você especificar um valor para `innodb_log_write_ahead_size` que seja maior do que o valor de `innodb_page_size`, a configuração de `innodb_log_write_ahead_size` será truncada para o valor de `innodb_page_size`.

  Definir o valor de `innodb_log_write_ahead_size` muito baixo em relação ao tamanho do bloco de *cache* do sistema operacional ou do sistema de arquivos resulta em "read-on-write". Definir o valor muito alto pode ter um leve impacto no desempenho de `fsync` para escritas em arquivos de *log* devido a vários blocos sendo escritos simultaneamente.