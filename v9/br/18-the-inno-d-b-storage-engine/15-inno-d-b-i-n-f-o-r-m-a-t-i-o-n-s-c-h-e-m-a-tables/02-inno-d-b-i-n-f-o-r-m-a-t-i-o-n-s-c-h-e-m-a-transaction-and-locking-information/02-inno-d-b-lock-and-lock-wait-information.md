#### 17.15.2.2 Informações sobre Bloqueios e Espera de Bloqueio do InnoDB

Quando uma transação atualiza uma linha em uma tabela ou bloqueia-a com `SELECT FOR UPDATE`, o `InnoDB` estabelece uma lista ou fila de bloqueios naquela linha. Da mesma forma, o `InnoDB` mantém uma lista de bloqueios em uma tabela para bloqueios de nível de tabela. Se uma segunda transação quiser atualizar uma linha ou bloquear uma tabela já bloqueada por uma transação anterior em um modo incompatível, o `InnoDB` adiciona uma solicitação de bloqueio para a linha à fila correspondente. Para que um bloqueio seja adquirido por uma transação, todas as solicitações de bloqueio incompatíveis previamente inseridas na fila de bloqueio para aquela linha ou tabela devem ser removidas (o que ocorre quando as transações que detêm ou solicitam esses bloqueios realizam um commit ou um rollback).

Uma transação pode ter qualquer número de solicitações de bloqueio para diferentes linhas ou tabelas. Em qualquer momento, uma transação pode solicitar um bloqueio que esteja sendo mantido por outra transação, caso em que é bloqueada por essa outra transação. A transação solicitante deve esperar que a transação que mantém o bloqueio que está bloqueando commit ou rollback. Se uma transação não estiver esperando por um bloqueio, ela está no estado `RUNNING` (em execução). Se uma transação estiver esperando por um bloqueio, ela está no estado `LOCK WAIT` (em espera de bloqueio). (A tabela `INNODB_TRX` do `INFORMATION_SCHEMA` indica os valores do estado da transação.)

A tabela `data_locks` do Schema de Desempenho contém uma ou mais linhas para cada transação `LOCK WAIT`, indicando quaisquer solicitações de bloqueio que impeçam seu progresso. Essa tabela também contém uma linha descrevendo cada bloqueio em uma fila de bloqueios pendentes para uma determinada linha ou tabela. A tabela `data_lock_waits` do Schema de Desempenho mostra quais bloqueios já mantidos por uma transação estão bloqueando solicitações de bloqueio feitas por outras transações.