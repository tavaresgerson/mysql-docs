#### 20.1.4.1 Membros do Grupo

No Replicação por Grupo do MySQL, um conjunto de servidores forma um grupo de replicação. Um grupo tem um nome, que assume a forma de um UUID. O grupo é dinâmico e os servidores podem sair (voluntariamente ou involuntariamente) e se juntar a ele a qualquer momento. O grupo se ajusta sempre que servidores se juntam ou saem.

Se um servidor se junta ao grupo, ele se atualiza automaticamente, obtendo o estado ausente de um servidor existente. Se um servidor deixa o grupo, por exemplo, foi desativado para manutenção, os servidores restantes percebem que ele saiu e reconfiguram o grupo automaticamente.

A Replicação por Grupo tem um serviço de associação de membros que define quais servidores estão online e participando do grupo. A lista de servidores online é referida como uma *visualização*. Cada servidor do grupo tem uma visão consistente de quais servidores são os membros que participam ativamente do grupo em um determinado momento.

Os membros do grupo devem concordar não apenas sobre os commits de transações, mas também sobre qual é a visão atual. Se os membros existentes concordarem que um novo servidor deve fazer parte do grupo, o grupo é reconfigurado para integrá-lo, o que desencadeia uma mudança na visão. Se um servidor deixa o grupo, voluntariamente ou não, o grupo rearrangia dinamicamente sua configuração e uma mudança na visão é desencadeada.

No caso de um membro sair do grupo voluntariamente, ele primeiro inicia uma reconfiguração dinâmica do grupo, durante a qual todos os membros precisam concordar com uma nova visão sem o servidor que está saindo. No entanto, se um membro sair do grupo involuntariamente, por exemplo, porque parou inesperadamente ou a conexão de rede está indisponível, ele não pode iniciar a reconfiguração. Nessa situação, o mecanismo de detecção de falha da Replicação em Grupo reconhece, após um curto período de tempo, que o membro saiu, e uma reconfiguração do grupo sem o membro falhado é proposta. Assim como com um membro que sai voluntariamente, a reconfiguração requer o acordo da maioria dos servidores do grupo. No entanto, se o grupo não conseguir chegar a um acordo, por exemplo, porque foi particionado de tal forma que não há maioria de servidores online, o sistema não consegue mudar dinamicamente a configuração e bloqueia para evitar uma situação de cérebro partido. Essa situação requer intervenção de um administrador.

É possível que um membro fique offline por um curto período de tempo, tente se reiniciar no grupo novamente antes que o mecanismo de detecção de falha tenha detectado sua falha e antes que o grupo tenha sido reconfigurado para remover o membro. Nessa situação, o membro que se reinicia esquece seu estado anterior, mas se outros membros enviam mensagens que são destinadas ao seu estado pré-falha, isso pode causar problemas, incluindo possíveis inconsistências de dados. Se um membro nessa situação participa do protocolo de consenso do XCom, isso poderia potencialmente fazer com que o XCom entregue valores diferentes para a mesma rodada de consenso, tomando uma decisão diferente antes e depois da falha.

Para contrariar essa possibilidade, o MySQL Group Replication verifica a situação em que uma nova encarnação do mesmo servidor está tentando se juntar ao grupo enquanto sua antiga encarnação (com o mesmo endereço e número de porta) ainda está listada como membro. A nova encarnação é bloqueada de se juntar ao grupo até que a antiga encarnação possa ser removida por uma reconfiguração. Observe que, se um período de espera foi adicionado pela variável de sistema `group_replication_member_expel_timeout` para permitir mais tempo para os membros se reconectar com o grupo antes de serem expulsos, um membro sob suspeita pode se tornar ativo no grupo novamente como sua encarnação atual se reconectar ao grupo antes que a suspeita expire. Quando um membro excede o tempo de expulsão e é expulso do grupo, ou quando a Replicação de Grupo é parada no servidor por uma declaração `STOP GROUP_REPLICATION` ou uma falha no servidor, ele deve se reconectar como uma nova encarnação.