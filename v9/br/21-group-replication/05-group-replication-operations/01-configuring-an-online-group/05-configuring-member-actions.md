#### 20.5.1.5 Configurando Ações de Membros

A Replicação em Grupo tem a capacidade de definir ações para os membros de um grupo a serem tomadas em situações específicas. As ações de membros podem ser habilitadas e desabilitadas individualmente usando funções. A configuração das ações de membros para um servidor também pode ser redefinida para o padrão após ele ter deixado o grupo.

Os administradores (com o privilégio `GROUP_REPLICATION_ADMIN`) podem configurar uma ação de membro no primário do grupo usando a função `group_replication_enable_member_action` ou `group_replication_disable_member_action`. A configuração das ações de membros, que consiste em todas as ações de membros e se elas estão habilitadas ou desabilitadas, é então propagada para outros membros do grupo e membros que estão se juntando usando as mensagens de grupo da Replicação em Grupo. Portanto, todos os membros do grupo têm a mesma configuração de ações de membros. Você também pode configurar ações de membros em um servidor que não faz parte de um grupo, desde que o plugin de Replicação em Grupo esteja instalado. Nesse caso, a configuração das ações de membros não é propagada para nenhum outro servidor.

Se o servidor onde você usa as funções para configurar uma ação de membro faz parte de um grupo, ele deve ser o primário atual em um grupo no modo de primário único e deve fazer parte da maioria. A mudança de configuração é rastreada internamente pela Replicação em Grupo, mas não recebe um GTID e não é escrita no log binário, portanto, não é propagada para nenhum servidor externo ao grupo, como réplicas descendentes. A Replicação em Grupo incrementa o número de versão para sua configuração de ações de membros toda vez que uma ação de membro é habilitada ou desabilitada.

A configuração das ações de membros é propagada para os membros da seguinte forma:

* Ao iniciar um grupo, a configuração das ações de membro do servidor que inicializa o grupo se torna a configuração do grupo.

* Se a versão mais baixa do Servidor MySQL de um grupo suportar ações de membro, os membros que se juntam recebem a configuração das ações de membro do grupo durante o processo de troca de estado que ocorre quando eles se juntam. Nesse caso, o membro que se junta substitui sua própria configuração de ações de membro pela do grupo.

* Se um membro que se junta e suporta ações de membro se juntar a um grupo onde a versão mais baixa do Servidor MySQL não suporta ações de membro, ele não recebe uma configuração de ações de membro quando se junta. Nesse caso, o membro que se junta redefiniria sua própria configuração para o padrão.

Um membro que não suporta ações de membro não pode se juntar a um grupo que tenha uma configuração de ações de membro, porque sua versão do Servidor MySQL é menor que a versão mais baixa que os membros do grupo existentes estão executando.

A tabela do Schema de Desempenho `replication_group_member_actions` lista as ações de membro que estão disponíveis na configuração, os eventos que as desencadeiam e se elas estão atualmente habilitadas ou não. As ações de membro têm uma prioridade de 1 a 100, com valores menores sendo executados primeiro. Se ocorrer um erro ao executar a ação de membro, o falha da ação de membro pode ser registrada, mas, caso contrário, ignorada. Se a falha da ação de membro for considerada crítica, ela pode ser tratada de acordo com a política especificada pela variável de sistema `group_replication_exit_state_action`.

A tabela `mysql.replication_group_configuration_version`, que pode ser visualizada usando a tabela do Schema de Desempenho `replication_group_configuration_version`, registra a versão atual da configuração das ações de membro. Sempre que uma ação de membro é habilitada ou desabilitada usando as funções, o número da versão é incrementado.

A função `group_replication_reset_member_actions` só pode ser usada em um servidor que não faça parte de um grupo. Ela redefere a configuração das ações de membro para as configurações padrão e redefere seu número de versão para 1. O servidor deve ser legível (com a variável de sistema `read_only` definida como `OFF`) e ter o plugin de Replicação de Grupo instalado. Você pode usar essa função para remover a configuração das ações de membro que um servidor usou quando fazia parte de um grupo, se você pretende usá-lo como um servidor autônomo sem ações de membro ou com ações de membro diferentes.

A ação de membro `mysql_disable_super_read_only_if_primary` pode ser configurada para que um grupo em modo single-primary permaneça no modo super read-only quando um novo primário é eleito; isso significa que o grupo aceita transações replicadas apenas e não aceita quaisquer escritas diretas de clientes. Essa configuração garante que, quando o grupo é destinado a fornecer um backup secundário para outro grupo para tolerância a desastres, você possa garantir que o grupo secundário permaneça sincronizado com o primeiro.

Por padrão, o modo de leitura apenas super é desativado no primário quando ele é eleito, para que o primário se torne de leitura/escrita e aceite atualizações de um servidor de origem de replicação e de clientes. Esta é a situação quando a ação do membro `mysql_disable_super_read_only_if_primary` é habilitada, que é sua configuração padrão. Se você definir a ação como desabilitada usando a função `group_replication_disable_member_action()`, o primário permanecerá no modo de leitura apenas super após a eleição. Neste estado, ele não aceita atualizações de nenhum cliente, mesmo usuários que tenham o privilégio `CONNECTION_ADMIN` ou `SUPER`. Ele continua a aceitar atualizações realizadas por threads de replicação.