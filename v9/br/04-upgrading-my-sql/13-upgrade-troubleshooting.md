## 3.13 Solução de problemas de atualização

* Uma incompatibilidade de esquema em uma instância MySQL 9.4 entre o arquivo `.frm` de uma tabela e o dicionário de dados `InnoDB` pode causar o fracasso da atualização para o MySQL 9.5. Tais incompatibilidades podem ser causadas por corrupção do arquivo `.frm`. Para resolver esse problema, faça um dump e um restore das tabelas afetadas antes de tentar a atualização novamente.

* Se ocorrerem problemas, como o novo servidor **mysqld** não iniciar, verifique se você não tem um arquivo `my.cnf` antigo da sua instalação anterior. Você pode verificar isso com a opção `--print-defaults` (por exemplo, **mysqld --print-defaults**). Se esse comando exibir algo além do nome do programa, você tem um arquivo `my.cnf` ativo que afeta o funcionamento do servidor ou do cliente.

* Se, após uma atualização, você tiver problemas com programas cliente compilados, como `Comandos fora de sincronia` ou descargas inesperadas do núcleo, provavelmente você usou arquivos de cabeçalho ou bibliotecas antigos ao compilar seus programas. Nesse caso, verifique a data do seu arquivo `mysql.h` e da biblioteca `libmysqlclient.a` para verificar se são da nova distribuição do MySQL. Se não forem, recompile seus programas com os novos cabeçalhos e bibliotecas. A recompilação também pode ser necessária para programas compilados contra a biblioteca cliente compartilhada se o número da versão principal da biblioteca tiver mudado (por exemplo, de `libmysqlclient.so.20` para `libmysqlclient.so.21`).

* Se você criou uma função carregável com um nome específico e atualizou o MySQL para uma versão que implementa uma nova função embutida com o mesmo nome, a função carregável se torna inacessível. Para corrigir isso, use `DROP FUNCTION` para descartar a função carregável e, em seguida, use `CREATE FUNCTION` para recriar a função carregável com um nome diferente e não conflitante. O mesmo acontece se a nova versão do MySQL implementar uma função embutida com o mesmo nome que uma função armazenada existente. Consulte a Seção 11.2.5, “Parágrafo de Análise e Resolução de Nomes de Função”, para as regras que descrevem como o servidor interpreta referências a diferentes tipos de funções.

* Se a atualização para o MySQL 9.5 falhar devido a algum dos problemas descritos na Seção 3.6, “Preparando sua instalação para atualização”, o servidor reverte todas as alterações no diretório de dados. Nesse caso, remova todos os arquivos de log de redo e reinicie o servidor MySQL 9.4 no diretório de dados existente para corrigir os erros. Os arquivos de log de redo (`ib_logfile*`) residem no diretório de dados do MySQL por padrão. Após corrigir os erros, realize um desligamento lento (definindo `innodb_fast_shutdown=0`) antes de tentar a atualização novamente.