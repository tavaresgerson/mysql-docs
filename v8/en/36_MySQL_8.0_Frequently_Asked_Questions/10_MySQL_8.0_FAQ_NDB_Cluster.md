## A.10 MySQL 8.0 FAQ: NDB Cluster

In the following section, we answer questions that are frequently asked about MySQL NDB Cluster and the `NDB` storage engine.

A.10.1. Which versions of the MySQL software support NDB Cluster? Do I have to compile from source?

A.10.2. What do “NDB” and “NDBCLUSTER” mean?

A.10.3. What is the difference between using NDB Cluster versus using MySQL Replication?

A.10.4. Do I need any special networking to run NDB Cluster? How do computers in a cluster communicate?

A.10.5. How many computers do I need to run an NDB Cluster, and why?

A.10.6. What do the different computers do in an NDB Cluster?

A.10.7. When I run the SHOW command in the NDB Cluster management client, I see a line of output that looks like this:

A.10.8. With which operating systems can I use NDB Cluster?

A.10.9. What are the hardware requirements for running NDB Cluster?

A.10.10. How much RAM do I need to use NDB Cluster? Is it possible to use disk memory at all?

A.10.11. What file systems can I use with NDB Cluster? What about network file systems or network shares?

A.10.12. Can I run NDB Cluster nodes inside virtual machines (such as those created by VMWare, VirtualBox, Parallels, or Xen)?

A.10.13. I am trying to populate an NDB Cluster database. The loading process terminates prematurely and I get an error message like this one:

A.10.14. NDB Cluster uses TCP/IP. Does this mean that I can run it over the Internet, with one or more nodes in remote locations?

A.10.15. Do I have to learn a new programming or query language to use NDB Cluster?

A.10.16. What programming languages and APIs are supported by NDB Cluster?

A.10.17. Does NDB Cluster include any management tools?

A.10.18. How do I find out what an error or warning message means when using NDB Cluster?

A.10.19. Is NDB Cluster transaction-safe? What isolation levels are supported?

A.10.20. What storage engines are supported by NDB Cluster?

A.10.21. In the event of a catastrophic failure— for example, the whole city loses power and my UPS fails—would I lose all my data?

A.10.22. Is it possible to use FULLTEXT indexes with NDB Cluster?

A.10.23. Can I run multiple nodes on a single computer?

A.10.24. Can I add data nodes to an NDB Cluster without restarting it?

A.10.25. Are there any limitations that I should be aware of when using NDB Cluster?

A.10.26. Does NDB Cluster support foreign keys?

A.10.27. How do I import an existing MySQL database into an NDB Cluster?

A.10.28. How do NDB Cluster nodes communicate with one another?

A.10.29. What is an arbitrator?

A.10.30. What data types are supported by NDB Cluster?

A.10.31. How do I start and stop NDB Cluster?

A.10.32. What happens to NDB Cluster data when the cluster is shut down?

A.10.33. Is it a good idea to have more than one management node for an NDB Cluster?

A.10.34. Can I mix different kinds of hardware and operating systems in one NDB Cluster?

A.10.35. Can I run two data nodes on a single host? Two SQL nodes?

A.10.36. Can I use host names with NDB Cluster?

A.10.37. Does NDB Cluster support IPv6?

A.10.38. How do I handle MySQL users in an NDB Cluster having multiple MySQL servers?

A.10.39. How do I continue to send queries in the event that one of the SQL nodes fails?

A.10.40. How do I back up and restore an NDB Cluster?

A.10.41. What is an “angel process”?

<table border="0" style="width: 100%;"><colgroup><col/></colgroup><tbody><tr class="question"><td align="left" valign="top"><p><b>A.10.1.</b></p></td><td align="left" valign="top"><p> Which versions of the MySQL software support NDB Cluster? Do I have to compile from source? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster is not supported in standard MySQL Server releases. Instead, MySQL NDB Cluster is provided as a separate product. Available NDB Cluster release series include the following: </p> <div class="itemizedlist"> <ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b>NDB Cluster 7.3 / NDB Cluster 7.4. </b> These two series are no longer maintained or supported for new deployments. Users of NDB Cluster 7.3 or 7.4 should upgrade to NDB 7.5 or newer as soon as possible. We recommend that new deployments use the latest NDB Cluster 8.0 release. </p></li><li class="listitem"><p><b>NDB Cluster 7.5. </b> This series is a previous General Availability (GA) version of NDB Cluster, still available for production use, although we recommend that new deployments use the latest NDB Cluster 8.0 release. The latest NDB Cluster 7.5 releases can be obtained from https://dev.mysql.com/downloads/cluster/. </p></li><li class="listitem"><p><b>NDB Cluster 7.6. </b> This series is a previous General Availability (GA) version of NDB Cluster, still available for production use, although we recommend that new deployments use the latest NDB Cluster 8.0 release. The latest NDB Cluster 7.6 releases can be obtained from https://dev.mysql.com/downloads/cluster/. </p></li><li class="listitem"><p><b>NDB Cluster 8.0. </b> This series is the most recent General Availability (GA) version of NDB Cluster, based on version 8.0 of the <code>NDB</code> storage engine and MySQL Server 8.0. NDB Cluster 8.0 is available for production use; new deployments intended for production should use the latest GA release in this series, which is currently NDB Cluster 8.0.44. You can obtain the most recent NDB Cluster 8.0 release from https://dev.mysql.com/downloads/cluster/. For information about new features and other important changes in this series, see Section 25.2.4, “What is New in MySQL NDB Cluster 8.0”. </p></li></ul> </div> <p> You can obtain and compile NDB Cluster from source (see Section 25.3.1.4, “Building NDB Cluster from Source on Linux”, and Section 25.3.2.2, “Compiling and Installing NDB Cluster from Source on Windows”), but for all but the most specialized cases, we recommend using one of the following installers provided by Oracle that is appropriate to your operating platform and circumstances: </p> <div class="itemizedlist"> <ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> Linux binary release (<code>tar.gz</code> file) </p></li><li class="listitem"><p> Linux RPM package </p></li><li class="listitem"><p> Linux <code>.deb</code> file </p></li><li class="listitem"><p> Windows binary <span class="quote">“<span class="quote">no-install</span>”</span> release </p></li><li class="listitem"><p> Windows MSI Installer </p></li></ul> </div> <p> Installation packages may also be available from your platform's package management system. </p><p> You can determine whether your MySQL Server has <code>NDB</code> support using one of the statements <code>SHOW VARIABLES LIKE 'have_%'</code>, <code>SHOW ENGINES</code>, or <code>SHOW PLUGINS</code>. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.2.</b></p></td><td align="left" valign="top"><p> What do <span class="quote">“<span class="quote">NDB</span>”</span> and <span class="quote">“<span class="quote">NDBCLUSTER</span>”</span> mean? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> <span class="quote">“<span class="quote">NDB</span>”</span> stands for <span class="quote">“<span class="quote"><span class="bold"><strong>N</strong></span>etwork <span class="bold"><strong>D</strong></span>ata<span class="bold"><strong>b</strong></span>ase</span>”</span>. <code>NDB</code> and <code>NDBCLUSTER</code> are both names for the storage engine that enables clustering support with MySQL. <code>NDB</code> is preferred, but either name is correct. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.3.</b></p></td><td align="left" valign="top"><p> What is the difference between using NDB Cluster versus using MySQL Replication? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> In traditional MySQL replication, a source MySQL server updates one or more replicas. Transactions are committed sequentially, and a slow transaction can cause the replica to lag behind the source. This means that if the source fails, it is possible that the replica might not have recorded the last few transactions. If a transaction-safe engine such as <code>InnoDB</code> is being used, a transaction is either completed on the replica or not applied at all, but replication does not guarantee that all data on the source and the replica remains consistent at all times. In NDB Cluster, all data nodes are kept in synchrony, and a transaction committed by any one data node is committed for all data nodes. In the event of a data node failure, all remaining data nodes remain in a consistent state. </p><p> In short, whereas standard MySQL replication is <span class="firstterm">asynchronous</span>, NDB Cluster is <span class="firstterm">synchronous</span>. </p><p> Asynchronous replication is also available in NDB Cluster. <span class="firstterm">NDB Cluster Replication</span> (also sometimes known as <span class="quote">“<span class="quote">geo-replication</span>”</span>) includes the capability to replicate both between two NDB Clusters, and from an NDB Cluster to a non-Cluster MySQL server. See Section 25.7, “NDB Cluster Replication”. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.4.</b></p></td><td align="left" valign="top"><p> Do I need any special networking to run NDB Cluster? How do computers in a cluster communicate? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster is intended to be used in a high-bandwidth environment, with computers connecting using TCP/IP. Its performance depends directly upon the connection speed between the cluster's computers. The minimum connectivity requirements for NDB Cluster include a typical 100-megabit Ethernet network or the equivalent. We recommend you use gigabit Ethernet whenever available. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.5.</b></p></td><td align="left" valign="top"><p> How many computers do I need to run an NDB Cluster, and why? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> A minimum of three computers is required to run a viable cluster. However, the minimum <span class="emphasis"><em>recommended</em></span> number of computers in an NDB Cluster is four: one each to run the management and SQL nodes, and two computers to serve as data nodes. The purpose of the two data nodes is to provide redundancy; the management node must run on a separate machine to guarantee continued arbitration services in the event that one of the data nodes fails. </p><p> To provide increased throughput and high availability, you should use multiple SQL nodes (MySQL Servers connected to the cluster). It is also possible (although not strictly necessary) to run multiple management servers. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.6.</b></p></td><td align="left" valign="top"><p> What do the different computers do in an NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> An NDB Cluster has both a physical and logical organization, with computers being the physical elements. The logical or functional elements of a cluster are referred to as <span class="firstterm">nodes</span>, and a computer housing a cluster node is sometimes referred to as a <span class="firstterm">cluster host</span>. There are three types of nodes, each corresponding to a specific role within the cluster. These are: </p> <div class="itemizedlist"> <ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b>Management node. </b> This node provides management services for the cluster as a whole, including startup, shutdown, backups, and configuration data for the other nodes. The management node server is implemented as the application <span><strong>ndb_mgmd</strong></span>; the management client used to control NDB Cluster is <span><strong>ndb_mgm</strong></span>. See Section 25.5.4, “ndb_mgmd — The NDB Cluster Management Server Daemon”, and Section 25.5.5, “ndb_mgm — The NDB Cluster Management Client”, for information about these programs. </p></li><li class="listitem"><p><b>Data node. </b> This type of node stores and replicates data. Data node functionality is handled by instances of the <code>NDB</code> data node process <span><strong>ndbd</strong></span>. For more information, see Section 25.5.1, “ndbd — The NDB Cluster Data Node Daemon”. </p></li><li class="listitem"><p><b>SQL node. </b> This is simply an instance of MySQL Server (<span><strong>mysqld</strong></span>) that is built with support for the <code>NDBCLUSTER</code> storage engine and started with the <code>--ndb-cluster</code> option to enable the engine and the <code>--ndb-connectstring</code> option to enable it to connect to an NDB Cluster management server. For more about these options, see Section 25.4.3.9.1, “MySQL Server Options for NDB Cluster”. </p> <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"> <div class="admon-title"> Note </div> <p> An <span class="firstterm">API node</span> is any application that makes direct use of Cluster data nodes for data storage and retrieval. An SQL node can thus be considered a type of API node that uses a MySQL Server to provide an SQL interface to the Cluster. You can write such applications (that do not depend on a MySQL Server) using the NDB API, which supplies a direct, object-oriented transaction and scanning interface to NDB Cluster data; see NDB Cluster API Overview: The NDB API, for more information. </p> </div> </li></ul> </div> </td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.7.</b></p></td><td align="left" valign="top"><p> When I run the <code>SHOW</code> command in the NDB Cluster management client, I see a line of output that looks like this: </p><pre class="programlisting copytoclipboard language-none one-line"><code class="language-none">id=2    @10.100.10.32  (Version: 8.0.44-ndb-8.0.44 Nodegroup: 0, *)</code></pre><p> What does the <code>*</code> mean? How is this node different from the others? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> The simplest answer is, <span class="quote">“<span class="quote">It's not something you can control, and it's nothing that you need to worry about in any case, unless you're a software engineer writing or analyzing the NDB Cluster source code</span>”</span>. </p><p> If you don't find that answer satisfactory, here's a longer and more technical version: </p><p> A number of mechanisms in NDB Cluster require distributed coordination among the data nodes. These distributed algorithms and protocols include global checkpointing, DDL (schema) changes, and node restart handling. To make this coordination simpler, the data nodes <span class="quote">“<span class="quote">elect</span>”</span> one of their number to act as leader. There is no user-facing mechanism for influencing this selection, which is completely automatic; the fact that it <span class="emphasis"><em>is</em></span> automatic is a key part of NDB Cluster's internal architecture. </p><p> When a node acts as the <span class="quote">“<span class="quote">leader</span>”</span> for any of these mechanisms, it is usually the point of coordination for the activity, and the other nodes act as <span class="quote">“<span class="quote">followers</span>”</span>, carrying out their parts of the activity as directed by the leader. If the node acting as leader fails, then the remaining nodes elect a new leader. Tasks in progress that were being coordinated by the old leader may either fail or be continued by the new leader, depending on the actual mechanism involved. </p><p> It is possible for some of these different mechanisms and protocols to have different leader nodes, but in general the same leader is chosen for all of them. The node indicated as the leader in the output of <code>SHOW</code> in the management client is known internally as the <code>DICT</code> manager, responsible for coordinating DDL and metadata activity. </p><p> NDB Cluster is designed in such a way that the choice of leader has no discernible effect outside the cluster itself. For example, the current leader does not have significantly higher CPU or resource usage than the other data nodes, and failure of the leader should not have a significantly different impact on the cluster than the failure of any other data node. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.8.</b></p></td><td align="left" valign="top"><p> With which operating systems can I use NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster is supported on most Unix-like operating systems. NDB Cluster is also supported in production settings on Microsoft Windows operating systems. </p><p> For more detailed information concerning the level of support which is offered for NDB Cluster on various operating system versions, operating system distributions, and hardware platforms, please refer to https://www.mysql.com/support/supportedplatforms/cluster.html. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.9.</b></p></td><td align="left" valign="top"><p> What are the hardware requirements for running NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster should run on any platform for which <code>NDB</code>-enabled binaries are available. For data nodes and API nodes, faster CPUs and more memory are likely to improve performance, and 64-bit CPUs are likely to be more effective than 32-bit processors. There must be sufficient memory on machines used for data nodes to hold each node's share of the database (see <span class="emphasis"><em>How much RAM do I Need?</em></span> for more information). For a computer which is used only for running the NDB Cluster management server, the requirements are minimal; a common desktop PC (or the equivalent) is generally sufficient for this task. Nodes can communicate through the standard TCP/IP network and hardware. They can also use the high-speed SCI protocol; however, special networking hardware and software are required to use SCI (see Section 25.4.4, “Using High-Speed Interconnects with NDB Cluster”). </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.10.</b></p></td><td align="left" valign="top"><p> How much RAM do I need to use NDB Cluster? Is it possible to use disk memory at all? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster was originally implemented as in-memory only, but all versions currently available also provide the ability to store NDB Cluster on disk. See Section 25.6.11, “NDB Cluster Disk Data Tables”, for more information. </p><p> For in-memory <code>NDB</code> tables, you can use the following formula for obtaining a rough estimate of how much RAM is needed for each data node in the cluster: </p><pre class="programlisting copytoclipboard language-simple one-line"><code class="language-simple">(SizeofDatabase × NumberOfReplicas × 1.1 ) / NumberOfDataNodes</code></pre><p> To calculate the memory requirements more exactly requires determining, for each table in the cluster database, the storage space required per row (see Section 13.7, “Data Type Storage Requirements”, for details), and multiplying this by the number of rows. You must also remember to account for any column indexes as follows: </p> <div class="itemizedlist"> <ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> Each primary key or hash index created for an <code>NDBCLUSTER</code> table requires 21−25 bytes per record. These indexes use <code>IndexMemory</code>. </p></li><li class="listitem"><p> Each ordered index requires 10 bytes storage per record, using <code>DataMemory</code>. </p></li><li class="listitem"><p> Creating a primary key or unique index also creates an ordered index, unless this index is created with <code>USING HASH</code>. In other words: </p> <div class="itemizedlist"> <ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> A primary key or unique index on a Cluster table normally takes up 31 to 35 bytes per record. </p></li><li class="listitem"><p> However, if the primary key or unique index is created with <code>USING HASH</code>, then it requires only 21 to 25 bytes per record. </p></li></ul> </div> </li></ul> </div> <p> Creating NDB Cluster tables with <code>USING HASH</code> for all primary keys and unique indexes generally causes table updates to run more quickly—in some cases by a much as 20 to 30 percent faster than updates on tables where <code>USING HASH</code> was not used in creating primary and unique keys. This is due to the fact that less memory is required (because no ordered indexes are created), and that less CPU must be utilized (because fewer indexes must be read and possibly updated). However, it also means that queries that could otherwise use range scans must be satisfied by other means, which can result in slower selects. </p><p> When calculating Cluster memory requirements, you may find useful the <span><strong>ndb_size.pl</strong></span> utility which is available in recent MySQL 8.0 releases. This Perl script connects to a current (non-Cluster) MySQL database and creates a report on how much space that database would require if it used the <code>NDBCLUSTER</code> storage engine. For more information, see Section 25.5.28, “ndb_size.pl — NDBCLUSTER Size Requirement Estimator”. </p><p> It is especially important to keep in mind that <span class="emphasis"><em>every NDB Cluster table must have a primary key</em></span>. The <code>NDB</code> storage engine creates a primary key automatically if none is defined; this primary key is created without <code>USING HASH</code>. </p><p> You can determine how much memory is being used for storage of NDB Cluster data and indexes at any given time using the <code>REPORT MEMORYUSAGE</code> command in the <span><strong>ndb_mgm</strong></span> client; see Section 25.6.1, “Commands in the NDB Cluster Management Client”, for more information. In addition, warnings are written to the cluster log when 80% of available <code>DataMemory</code> or (prior to NDB 7.6) <code>IndexMemory</code> is in use, and again when usage reaches 90%, 99%, and 100%. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.11.</b></p></td><td align="left" valign="top"><p> What file systems can I use with NDB Cluster? What about network file systems or network shares? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Generally, any file system that is native to the host operating system should work well with NDB Cluster. If you find that a given file system works particularly well (or not so especially well) with NDB Cluster, we invite you to discuss your findings in the NDB Cluster Forums. </p><p> For Windows, we recommend that you use <code>NTFS</code> file systems for NDB Cluster, just as we do for standard MySQL. We do not test NDB Cluster with <code>FAT</code> or <code>VFAT</code> file systems. Because of this, we do not recommend their use with MySQL or NDB Cluster. </p><p> NDB Cluster is implemented as a shared-nothing solution; the idea behind this is that the failure of a single piece of hardware should not cause the failure of multiple cluster nodes, or possibly even the failure of the cluster as a whole. For this reason, the use of network shares or network file systems is not supported for NDB Cluster. This also applies to shared storage devices such as SANs. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.12.</b></p></td><td align="left" valign="top"><p> Can I run NDB Cluster nodes inside virtual machines (such as those created by VMWare, VirtualBox, Parallels, or Xen)? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster is supported for use in virtual machines. We currently support and test using Oracle VM. </p><p> Some NDB Cluster users have successfully deployed NDB Cluster using other virtualization products; in such cases, Oracle can provide NDB Cluster support, but issues specific to the virtual environment must be referred to that product's vendor. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.13.</b></p></td><td align="left" valign="top"><p> I am trying to populate an NDB Cluster database. The loading process terminates prematurely and I get an error message like this one: </p><p> <code><span class="errortext">ERROR 1114: The table 'my_cluster_table' is full</span></code> </p><p> Why is this happening? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> The cause is very likely to be that your setup does not provide sufficient RAM for all table data and all indexes, <span class="emphasis"><em>including the primary key required by the <code>NDB</code> storage engine and automatically created in the event that the table definition does not include the definition of a primary key</em></span>. </p><p> It is also worth noting that all data nodes should have the same amount of RAM, since no data node in a cluster can use more memory than the least amount available to any individual data node. For example, if there are four computers hosting Cluster data nodes, and three of these have 3GB of RAM available to store Cluster data while the remaining data node has only 1GB RAM, then each data node can devote at most 1GB to NDB Cluster data and indexes. </p><p> In some cases it is possible to get <span class="errortext">Table is full</span> errors in MySQL client applications even when <span><strong>ndb_mgm -e "ALL REPORT MEMORYUSAGE"</strong></span> shows significant free <code>DataMemory</code>. You can force <code>NDB</code> to create extra partitions for NDB Cluster tables and thus have more memory available for hash indexes by using the <code>MAX_ROWS</code> option for <code>CREATE TABLE</code>. In general, setting <code>MAX_ROWS</code> to twice the number of rows that you expect to store in the table should be sufficient. </p><p> For similar reasons, you can also sometimes encounter problems with data node restarts on nodes that are heavily loaded with data. The <code>MinFreePct</code> parameter can help with this issue by reserving a portion (5% by default) of <code>DataMemory</code> and (prior to NDB 7.6) <code>IndexMemory</code> for use in restarts. This reserved memory is not available for storing <code>NDB</code> tables or data. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.14.</b></p></td><td align="left" valign="top"><p> NDB Cluster uses TCP/IP. Does this mean that I can run it over the Internet, with one or more nodes in remote locations? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> It is <span class="emphasis"><em>very</em></span> unlikely that a cluster would perform reliably under such conditions, as NDB Cluster was designed and implemented with the assumption that it would be run under conditions guaranteeing dedicated high-speed connectivity such as that found in a LAN setting using 100 Mbps or gigabit Ethernet—preferably the latter. We neither test nor warrant its performance using anything slower than this. </p><p> Also, it is extremely important to keep in mind that communications between the nodes in an NDB Cluster are not secure; they are neither encrypted nor safeguarded by any other protective mechanism. The most secure configuration for a cluster is in a private network behind a firewall, with no direct access to any Cluster data or management nodes from outside. (For SQL nodes, you should take the same precautions as you would with any other instance of the MySQL server.) For more information, see Section 25.6.20, “NDB Cluster Security Issues”. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.15.</b></p></td><td align="left" valign="top"><p> Do I have to learn a new programming or query language to use NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> <span class="emphasis"><em>No</em></span>. Although some specialized commands are used to manage and configure the cluster itself, only standard (My)SQL statements are required for the following operations: </p> <div class="itemizedlist"> <ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> Creating, altering, and dropping tables </p></li><li class="listitem"><p> Inserting, updating, and deleting table data </p></li><li class="listitem"><p> Creating, changing, and dropping primary and unique indexes </p></li></ul> </div> <p> Some specialized configuration parameters and files are required to set up an NDB Cluster—see Section 25.4.3, “NDB Cluster Configuration Files”, for information about these. </p><p> A few simple commands are used in the NDB Cluster management client (<span><strong>ndb_mgm</strong></span>) for tasks such as starting and stopping cluster nodes. See Section 25.6.1, “Commands in the NDB Cluster Management Client”. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.16.</b></p></td><td align="left" valign="top"><p> What programming languages and APIs are supported by NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster supports the same programming APIs and languages as the standard MySQL Server, including ODBC, .Net, the MySQL C API, and numerous drivers for popular scripting languages such as PHP, Perl, and Python. NDB Cluster applications written using these APIs behave similarly to other MySQL applications; they transmit SQL statements to a MySQL Server (in the case of NDB Cluster, an SQL node), and receive responses containing rows of data. For more information about these APIs, see Chapter 31, <i>Connectors and APIs</i>. </p><p> NDB Cluster also supports application programming using the NDB API, which provides a low-level C++ interface to NDB Cluster data without needing to go through a MySQL Server. See The NDB API. In addition, many <code>NDBCLUSTER</code> management functions are exposed by the C-language MGM API; see The MGM API, for more information. </p><p> NDB Cluster also supports Java application programming using ClusterJ, which supports a domain object model of data using sessions and transactions. See Java and NDB Cluster, for more information. </p><p> NDB Cluster 8.0 also includes adapters supporting NoSQL applications written against <code>Node.js</code>, with NDB Cluster as the data store. See MySQL NoSQL Connector for JavaScript, for more information. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.17.</b></p></td><td align="left" valign="top"><p> Does NDB Cluster include any management tools? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster includes a command line client for performing basic management functions. See Section 25.5.5, “ndb_mgm — The NDB Cluster Management Client”, and Section 25.6.1, “Commands in the NDB Cluster Management Client”. </p><p> NDB Cluster is also supported by MySQL Cluster Manager, a separate product providing an advanced command line interface that can automate many NDB Cluster management tasks such as rolling restarts and configuration changes. For more information about MySQL Cluster Manager, see MySQL Cluster Manager 8.0.43 User Manual. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.18.</b></p></td><td align="left" valign="top"><p> How do I find out what an error or warning message means when using NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> There are two ways in which this can be done: </p> <div class="itemizedlist"> <ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> From within the <span><strong>mysql</strong></span> client, use <span><strong>SHOW ERRORS</strong></span> or <span><strong>SHOW WARNINGS</strong></span> immediately upon being notified of the error or warning condition. </p></li><li class="listitem"><p> From a system shell prompt, use <span><strong>perror --ndb <em class="replaceable"><code>error_code</code></em></strong></span>. </p></li></ul> </div> </td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.19.</b></p></td><td align="left" valign="top"><p> Is NDB Cluster transaction-safe? What isolation levels are supported? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> <span class="emphasis"><em>Yes</em></span>. For tables created with the <code>NDB</code> storage engine, transactions are supported. Currently, NDB Cluster supports only the <code>READ COMMITTED</code> transaction isolation level. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.20.</b></p></td><td align="left" valign="top"><p> What storage engines are supported by NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster requires the <code>NDB</code> storage engine. That is, in order for a table to be shared between nodes in an NDB Cluster, the table must be created using <code>ENGINE=NDB</code> (or the equivalent option <code>ENGINE=NDBCLUSTER</code>). </p><p> It is possible to create tables using other storage engines (such as <code>InnoDB</code> or <code>MyISAM</code>) on a MySQL server being used with NDB Cluster, but since these tables do not use <code>NDB</code>, they do not participate in clustering; each such table is strictly local to the individual MySQL server instance on which it is created. </p><p> NDB Cluster is quite different from <code>InnoDB</code> clustering with regard to architecture, requirements, and implementation; despite any similarity in their names, the two are not compatible. For more information about <code>InnoDB</code> clustering, see MySQL AdminAPI. See also Section 25.2.6, “MySQL Server Using InnoDB Compared with NDB Cluster”, for information about the differences between the <code>NDB</code> and <code>InnoDB</code> storage engines. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.21.</b></p></td><td align="left" valign="top"><p> In the event of a catastrophic failure— for example, the whole city loses power <span class="emphasis"><em>and</em></span> my UPS fails—would I lose all my data? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> All committed transactions are logged. Therefore, although it is possible that some data could be lost in the event of a catastrophe, this should be quite limited. Data loss can be further reduced by minimizing the number of operations per transaction. (It is not a good idea to perform large numbers of operations per transaction in any case.) </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.22.</b></p></td><td align="left" valign="top"><p> Is it possible to use <code>FULLTEXT</code> indexes with NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> <code>FULLTEXT</code> indexing is currently supported only by the <code>InnoDB</code> and <code>MyISAM</code> storage engines. See Section 14.9, “Full-Text Search Functions”, for more information. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.23.</b></p></td><td align="left" valign="top"><p> Can I run multiple nodes on a single computer? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> It is possible but not always advisable. One of the chief reasons to run a cluster is to provide redundancy. To obtain the full benefits of this redundancy, each node should reside on a separate machine. If you place multiple nodes on a single machine and that machine fails, you lose all of those nodes. For this reason, if you do run multiple data nodes on a single machine, it is <span class="emphasis"><em>extremely</em></span> important that they be set up in such a way that the failure of this machine does not cause the loss of all the data nodes in a given node group. </p><p> Given that NDB Cluster can be run on commodity hardware loaded with a low-cost (or even no-cost) operating system, the expense of an extra machine or two is well worth it to safeguard mission-critical data. It also worth noting that the requirements for a cluster host running a management node are minimal. This task can be accomplished with a 300 MHz Pentium or equivalent CPU and sufficient RAM for the operating system, plus a small amount of overhead for the <span><strong>ndb_mgmd</strong></span> and <span><strong>ndb_mgm</strong></span> processes. </p><p> It is acceptable to run multiple cluster data nodes on a single host that has multiple CPUs, cores, or both. The NDB Cluster distribution also provides a multithreaded version of the data node binary intended for use on such systems. For more information, see Section 25.5.3, “ndbmtd — The NDB Cluster Data Node Daemon (Multi-Threaded)”. </p><p> It is also possible in some cases to run data nodes and SQL nodes concurrently on the same machine; how well such an arrangement performs is dependent on a number of factors such as number of cores and CPUs as well as the amount of disk and memory available to the data node and SQL node processes, and you must take these factors into account when planning such a configuration. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.24.</b></p></td><td align="left" valign="top"><p> Can I add data nodes to an NDB Cluster without restarting it? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> It is possible to add new data nodes to a running NDB Cluster without taking the cluster offline. For more information, see Section 25.6.7, “Adding NDB Cluster Data Nodes Online”. </p><p> For other types of NDB Cluster nodes, a rolling restart is all that is required (see Section 25.6.5, “Performing a Rolling Restart of an NDB Cluster”). </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.25.</b></p></td><td align="left" valign="top"><p> Are there any limitations that I should be aware of when using NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Limitations on <code>NDB</code> tables in MySQL NDB Cluster include the following: </p> <div class="itemizedlist"> <ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> Temporary tables are not supported; a <code>CREATE TEMPORARY TABLE</code> statement using <code>ENGINE=NDB</code> or <code>ENGINE=NDBCLUSTER</code> fails with an error. </p></li><li class="listitem"><p> The only types of user-defined partitioning supported for <code>NDBCLUSTER</code> tables are <code>KEY</code> and <code>LINEAR KEY</code>. Trying to create an <code>NDB</code> table using any other partitioning type fails with an error. </p></li><li class="listitem"><p> <code>FULLTEXT</code> indexes are not supported. </p></li><li class="listitem"><p> Index prefixes are not supported. Only complete columns may be indexed. </p></li><li class="listitem"><p> Spatial indexes are not supported (although spatial columns can be used). See Section 13.4, “Spatial Data Types”. </p></li><li class="listitem"><p> Support for partial transactions and partial rollbacks is comparable to that of other transactional storage engines such as <code>InnoDB</code> that can roll back individual statements. </p></li><li class="listitem"><p> The maximum number of attributes allowed per table is 512. Attribute names cannot be any longer than 31 characters. For each table, the maximum combined length of the table and database names is 122 characters. </p></li><li class="listitem"><p> Priot to NDB 8.0, the maximum size for a table row is 14 kilobytes, not counting <code>BLOB</code> values. In NDB 8.0, this maximum is increased to 30000 bytes. See Section 25.2.7.5, “Limits Associated with Database Objects in NDB Cluster”, for more information. </p><p> There is no set limit for the number of rows per <code>NDB</code> table. Limits on table size depend on a number of factors, in particular on the amount of RAM available to each data node. </p></li></ul> </div> <p> For a complete listing of limitations in NDB Cluster, see Section 25.2.7, “Known Limitations of NDB Cluster”. See also Section 25.2.7.11, “Previous NDB Cluster Issues Resolved in NDB Cluster 8.0”. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.26.</b></p></td><td align="left" valign="top"><p> Does NDB Cluster support foreign keys? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster provides support for foreign key constraints which is comparable to that found in the <code>InnoDB</code> storage engine; see Section 1.6.3.2, “FOREIGN KEY Constraints”, for more detailed information, as well as Section 15.1.20.5, “FOREIGN KEY Constraints”. Applications requiring foreign key support should use NDB Cluster 7.3, 7.4, 7.5, or later. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.27.</b></p></td><td align="left" valign="top"><p> How do I import an existing MySQL database into an NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> You can import databases into NDB Cluster much as you would with any other version of MySQL. Other than the limitations mentioned elsewhere in this FAQ, the only other special requirement is that any tables to be included in the cluster must use the <code>NDB</code> storage engine. This means that the tables must be created with <code>ENGINE=NDB</code> or <code>ENGINE=NDBCLUSTER</code>. </p><p> It is also possible to convert existing tables that use other storage engines to <code>NDBCLUSTER</code> using one or more <code>ALTER TABLE</code> statement. However, the definition of the table must be compatible with the <code>NDBCLUSTER</code> storage engine prior to making the conversion. In MySQL 8.0, an additional workaround is also required; see Section 25.2.7, “Known Limitations of NDB Cluster”, for details. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.28.</b></p></td><td align="left" valign="top"><p> How do NDB Cluster nodes communicate with one another? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Cluster nodes can communicate through any of three different transport mechanisms: TCP/IP, SHM (shared memory), and SCI (Scalable Coherent Interface). Where available, SHM is used by default between nodes residing on the same cluster host; however, this is considered experimental. SCI is a high-speed (1 gigabit per second and higher), high-availability protocol used in building scalable multi-processor systems; it requires special hardware and drivers. See Section 25.4.4, “Using High-Speed Interconnects with NDB Cluster”, for more about using SCI as a transport mechanism for NDB Cluster. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.29.</b></p></td><td align="left" valign="top"><p> What is an <span class="firstterm">arbitrator</span>? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> If one or more data nodes in a cluster fail, it is possible that not all cluster data nodes are able to <span class="quote">“<span class="quote">see</span>”</span> one another. In fact, it is possible that two sets of data nodes might become isolated from one another in a network partitioning, also known as a <span class="quote">“<span class="quote">split-brain</span>”</span> scenario. This type of situation is undesirable because each set of data nodes tries to behave as though it is the entire cluster. An arbitrator is required to decide between the competing sets of data nodes. </p><p> When all data nodes in at least one node group are alive, network partitioning is not an issue, because no single subset of the cluster can form a functional cluster on its own. The real problem arises when no single node group has all its nodes alive, in which case network partitioning (the <span class="quote">“<span class="quote">split-brain</span>”</span> scenario) becomes possible. Then an arbitrator is required. All cluster nodes recognize the same node as the arbitrator, which is normally the management server; however, it is possible to configure any of the MySQL Servers in the cluster to act as the arbitrator instead. The arbitrator accepts the first set of cluster nodes to contact it, and tells the remaining set to shut down. Arbitrator selection is controlled by the <code>ArbitrationRank</code> configuration parameter for MySQL Server and management server nodes. You can also use the <code>ArbitrationRank</code> configuration parameter to control the arbitrator selection process. For more information about these parameters, see Section 25.4.3.5, “Defining an NDB Cluster Management Server”. </p><p> The role of arbitrator does not in and of itself impose any heavy demands upon the host so designated, and thus the arbitrator host does not need to be particularly fast or to have extra memory especially for this purpose. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.30.</b></p></td><td align="left" valign="top"><p> What data types are supported by NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> NDB Cluster supports all of the usual MySQL data types, including those associated with MySQL's spatial extensions; however, the <code>NDB</code> storage engine does not support spatial indexes. (Spatial indexes are supported only by <code>MyISAM</code>; see Section 13.4, “Spatial Data Types”, for more information.) In addition, there are some differences with regard to indexes when used with <code>NDB</code> tables. </p> <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"> <div class="admon-title"> Note </div> <p> NDB Cluster Disk Data tables (that is, tables created with <code>TABLESPACE ... STORAGE DISK ENGINE=NDB</code> or <code>TABLESPACE ... STORAGE DISK ENGINE=NDBCLUSTER</code>) have only fixed-width rows. This means that (for example) each Disk Data table record containing a <code>VARCHAR(255)</code> column requires space for 255 characters (as required for the character set and collation being used for the table), regardless of the actual number of characters stored therein. </p> </div> <p> See Section 25.2.7, “Known Limitations of NDB Cluster”, for more information about these issues. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.31.</b></p></td><td align="left" valign="top"><p> How do I start and stop NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> It is necessary to start each node in the cluster separately, in the following order: </p> <div class="orderedlist"> <ol class="orderedlist" type="1"><li class="listitem"><p> Start the management node, using the <span><strong>ndb_mgmd</strong></span> command. </p><p> When starting the cluster for the first time, you must include the <code>-f</code> or <code>--config-file</code> option to tell the management node where its configuration file can be found. </p></li><li class="listitem"><p> Start each data node with the <span><strong>ndbd</strong></span> command. </p><p> Each data node must be started with the <code>-c</code> or <code>--ndb-connectstring</code> option so that the data node knows how to connect to the management server. </p></li><li class="listitem"><p> Start each MySQL Server (SQL node) using your preferred startup script, such as <span><strong>mysqld_safe</strong></span>. </p><p> Each MySQL Server must be started with the <code>--ndbcluster</code> and <code>--ndb-connectstring</code> options. These options cause <span><strong>mysqld</strong></span> to enable <code>NDBCLUSTER</code> storage engine support and how to connect to the management server. </p></li></ol> </div> <p> Each of these commands must be run from a system shell on the machine housing the affected node. (You do not have to be physically present at the machine—a remote login shell can be used for this purpose.) You can verify that the cluster is running by starting the <code>NDB</code> management client <span><strong>ndb_mgm</strong></span> on the machine housing the management node and issuing the <code>SHOW</code> or <code>ALL STATUS</code> command. </p><p> To shut down a running cluster, issue the command <code>SHUTDOWN</code> in the management client. Alternatively, you may enter the following command in a system shell: </p><pre class="programlisting copytoclipboard language-terminal one-line"><code class="language-terminal">$&gt; ndb_mgm -e "SHUTDOWN"</code></pre><p> (The quotation marks in this example are optional, since there are no spaces in the command string following the <code>-e</code> option; in addition, the <code>SHUTDOWN</code> command, like other management client commands, is not case-sensitive.) </p><p> Either of these commands causes the <span><strong>ndb_mgm</strong></span>, <span><strong>ndb_mgm</strong></span>, and any <span><strong>ndbd</strong></span> processes to terminate gracefully. MySQL servers running as SQL nodes can be stopped using <span><strong>mysqladmin shutdown</strong></span>. </p><p> For more information, see Section 25.6.1, “Commands in the NDB Cluster Management Client”, and Section 25.3.6, “Safe Shutdown and Restart of NDB Cluster”. </p><p> MySQL Cluster Manager provides additional ways to handle starting ansd stopping of NDB Cluster nodes. See MySQL Cluster Manager 8.0.43 User Manual, for more information about this tool. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.32.</b></p></td><td align="left" valign="top"><p> What happens to NDB Cluster data when the cluster is shut down? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> The data that was held in memory by the cluster's data nodes is written to disk, and is reloaded into memory the next time that the cluster is started. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.33.</b></p></td><td align="left" valign="top"><p> Is it a good idea to have more than one management node for an NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> It can be helpful as a fail-safe. Only one management node controls the cluster at any given time, but it is possible to configure one management node as primary, and one or more additional management nodes to take over in the event that the primary management node fails. </p><p> See Section 25.4.3, “NDB Cluster Configuration Files”, for information on how to configure NDB Cluster management nodes. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.34.</b></p></td><td align="left" valign="top"><p> Can I mix different kinds of hardware and operating systems in one NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Yes, as long as all machines and operating systems have the same <span class="quote">“<span class="quote">endianness</span>”</span> (all big-endian or all little-endian). </p><p> It is also possible to use software from different NDB Cluster releases on different nodes. However, we support such use only as part of a rolling upgrade procedure (see Section 25.6.5, “Performing a Rolling Restart of an NDB Cluster”). </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.35.</b></p></td><td align="left" valign="top"><p> Can I run two data nodes on a single host? Two SQL nodes? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Yes, it is possible to do this. In the case of multiple data nodes, it is advisable (but not required) for each node to use a different data directory. If you want to run multiple SQL nodes on one machine, each instance of <span><strong>mysqld</strong></span> must use a different TCP/IP port. </p><p> Running data nodes and SQL nodes together on the same host is possible, but you should be aware that the <span><strong>ndbd</strong></span> or <span><strong>ndbmtd</strong></span> processes may compete for memory with <span><strong>mysqld</strong></span>. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.36.</b></p></td><td align="left" valign="top"><p> Can I use host names with NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> Yes, it is possible to use DNS and DHCP for cluster hosts. However, if your application requires <span class="quote">“<span class="quote">five nines</span>”</span> availability, you should use fixed (numeric) IP addresses, since making communication between Cluster hosts dependent on services such as DNS and DHCP introduces additional potential points of failure. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.37.</b></p></td><td align="left" valign="top"><p> Does NDB Cluster support IPv6? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><b>Prior to NDB 8.0.22. </b> IPv6 is supported for connections between SQL nodes (MySQL servers), but connections between all other types of NDB Cluster nodes must use IPv4. </p><p> In practical terms, this means that you can use IPv6 for replication between NDB Clusters, but connections between nodes in the same NDB Cluster must use IPv4. For more information, see Section 25.7.3, “Known Issues in NDB Cluster Replication”. </p><p><b>NDB 8.0.22 and later. </b> All types of NDB Cluster nodes support IPv6; this includes management nodes, data nodes, and API or SQL nodes. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.38.</b></p></td><td align="left" valign="top"><p> How do I handle MySQL users in an NDB Cluster having multiple MySQL servers? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> MySQL user accounts and privileges are normally not automatically propagated between different MySQL servers accessing the same NDB Cluster. MySQL NDB Cluster provides support for shared and synchronized users and privileges using the <code>NDB_STORED_USER</code> privilege; see Distributed Privileges Using Shared Grant Tables, for more information. You should be aware that this implementation was introduced in NDB 8.0, and is not compatible with the shared privileges mechanism employed in earlier versions of NDB Cluster. The older implementation is no longer supported in NDB 8.0. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.39.</b></p></td><td align="left" valign="top"><p> How do I continue to send queries in the event that one of the SQL nodes fails? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> MySQL NDB Cluster does not provide any sort of automatic failover between SQL nodes. Your application must be prepared to handle the loss of SQL nodes and to fail over between them. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.40.</b></p></td><td align="left" valign="top"><p> How do I back up and restore an NDB Cluster? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> You can use the NDB Cluster native backup and restore functionality in the NDB management client and the <span><strong>ndb_restore</strong></span> program. See Section 25.6.8, “Online Backup of NDB Cluster”, and Section 25.5.23, “ndb_restore — Restore an NDB Cluster Backup”. </p><p> You can also use the traditional functionality provided for this purpose in <span><strong>mysqldump</strong></span> and the MySQL server. See Section 6.5.4, “mysqldump — A Database Backup Program”, for more information. </p></td></tr><tr class="question"><td align="left" valign="top"><p><b>A.10.41.</b></p></td><td align="left" valign="top"><p> What is an <span class="quote">“<span class="quote">angel process</span>”</span>? </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p> This process monitors and, if necessary, attempts to restart the data node process. If you check the list of active processes on your system after starting <span><strong>ndbd</strong></span>, you can see that there are actually 2 processes running by that name, as shown here (we omit the output from <span><strong>ndb_mgmd</strong></span> and <span><strong>ndbd</strong></span> for brevity): </p><pre class="programlisting copytoclipboard language-terminal"><code class="language-terminal">$&gt; ./ndb_mgmd

$&gt; ps aux | grep ndb me      23002  0.0  0.0 122948  3104 ?        Ssl  14:14   0:00 ./ndb_mgmd me      23025  0.0  0.0   5284   820 pts/2    S+   14:14   0:00 grep ndb

$&gt; ./ndbd -c 127.0.0.1 --initial

$&gt; ps aux | grep ndb me      23002  0.0  0.0 123080  3356 ?        Ssl  14:14   0:00 ./ndb_mgmd me      23096  0.0  0.0  35876  2036 ?        Ss   14:14   0:00 ./ndbmtd -c 127.0.0.1 --initial me      23097  1.0  2.4 524116 91096 ?        Sl   14:14   0:00 ./ndbmtd -c 127.0.0.1 --initial me      23168  0.0  0.0   5284   812 pts/2    R+   14:15   0:00 grep ndb</code></pre><p> The <span><strong>ndbd</strong></span> process showing <code>0.0</code> for both memory and CPU usage is the angel process (although it actually does use a very small amount of each). This process merely checks to see if the main <span><strong>ndbd</strong></span> or <span><strong>ndbmtd</strong></span> process (the primary data node process which actually handles the data) is running. If permitted to do so (for example, if the <code>StopOnError</code> configuration parameter is set to <code>false</code>), the angel process tries to restart the primary data node process. </p></td></tr></tbody></table>
