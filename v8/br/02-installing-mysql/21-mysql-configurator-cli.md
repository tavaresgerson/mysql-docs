#### 2.3.2.2 CLI do configurador MySQL

O MySQL Configurator suporta GUI (padrão) e CLI (passando em `--console`) modos usando o `mysql_configurator.exe` executável.

::: info Note

A funcionalidade CLI do MySQL Configurator foi adicionada no MySQL Configurator 9.2.0.

:::

A execução do MySQL Configurator requer um usuário do Windows com privilégios administrativos, pois caso contrário o sistema solicita as credenciais.

##### Síntese da CLI

A sintaxe geral é:

```
mysql_configurator.exe --console [--help] | [--action=action_name | -a=action_name] | ...]
```

**Tabela 2.6 Síntese**

<table summary="Sintaxe da interface de linha de comando do MySQL Configurator"><col style="width: 20%"/><col style="width: 10%"/><col style="width: 20%"/><col style="width: 20%"/><col style="width: 30%"/><thead><tr> <th scope="col">Nome da opção</th> <th scope="col">Atalhos</th> <th scope="col">Valores suportados</th> <th scope="col">Exemplo de uso</th> <th scope="col">Descrição</th> </tr></thead><tbody><tr> <td>consola</td> <td>c)</td> <td>Classificação</td> <td>- consola</td> <td>Ativa a CLI no MySQL Configurator, caso contrário, a GUI é lançada.</td> </tr><tr> <td>Ação</td> <td>a)</td> <td>Configurar, reconfigurar, remover ou atualizar</td> <td>--acção=configurar</td> <td>Executa o CLI do configurador MySQL no modo de nova configuração, reconfiguração, remoção ou atualização.</td> </tr><tr> <td>Ajuda .</td> <td>A</td> <td>Classificação</td> <td>- Ajuda .</td> <td>Mostra ajuda geral ou ajuda para a ação correspondente. Se nenhum elemento [[<code>--action</code>]] for fornecido, a seção de ajuda geral é exibida.</td> </tr><tr> <td>Opção de acção e valor</td> <td>Classificação</td> <td>Ver secção "Configurar/Reconfigurar/Remover/Atualizar opções" para valores suportados e detalhes</td> <td>- Não, não,</td> <td>Define as várias opções de configuração disponíveis para cada ação do CLI (configuração, reconfiguração, remoção ou atualização)</td> </tr></tbody></table>

##### Ações disponíveis

Cada ação (configurar, reconfigurar, remover e atualizar) tem um conjunto específico de opções que definem os elementos a serem configurados ao executar a operação. A sintaxe é `--action_option`=`action_value` com uma lista completa de opções de ação abaixo:

**Tabela 2.7 Opções de acção**

<table summary="Ações da interface da linha de comando do MySQL Configurator"><col style="width: 15%"/><col style="width: 5%"/><col style="width: 10%"/><col style="width: 5%"/><col style="width: 5%"/><col style="width: 20%"/><col style="width: 5%"/><col style="width: 10%"/><col style="width: 20%"/><thead><tr> <th scope="col">Opção de acção</th> <th scope="col">Atalhos</th> <th scope="col">Aliases</th> <th scope="col">Tipo do produto</th> <th scope="col">Valores</th> <th scope="col">Valor por defeito</th> <th scope="col">Acção</th> <th scope="col">Condição</th> <th scope="col">Descrição</th> </tr></thead><tbody><tr> <td>datação</td> <td>d</td> <td>data-dir, diretório de dados</td> <td>Percurso</td> <td>Classificação</td> <td>"C: ProgramDataMySQLMySQL Server x.x" onde [[<code>x.x</code>]] corresponde à versão principal e secundária do servidor correspondente.</td> <td>Configuração</td> <td>Classificação</td> <td>O caminho para o diretório de dados do servidor MySQL. Esta opção define a variável de sistema [[<code>datadir</code>]].</td> </tr><tr> <td>tipo de configuração</td> <td>Classificação</td> <td>tipo de configuração</td> <td>Lista</td> <td>Desenvolvedor, Servidor, Dedicado, Manual</td> <td>desenvolvimento</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Otimiza os recursos do sistema dependendo do uso pretendido da instância do servidor.</td> </tr><tr> <td>Ativar-tcp-ip</td> <td>Classificação</td> <td>Classificação</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Verdade</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Indica se o servidor permite conexões através de TCP/IP.</td> </tr><tr> <td>Porto</td> <td>P</td> <td>Classificação</td> <td>número</td> <td>Classificação</td> <td>Classificação</td> <td>Configurar, reconfigurar</td> <td>enable-tcp-id=true</td> <td>O número de porta a utilizar para a escuta de conexões TCP/IP.</td> </tr><tr> <td>mysqlx-port (em inglês)</td> <td>X</td> <td>x-port, xport</td> <td>número</td> <td>Classificação</td> <td>Classificação</td> <td>Configurar, reconfigurar</td> <td>enable-tcp-ip=true</td> <td>A porta de rede na qual o X Plugin escuta as conexões TCP/IP. Este é o equivalente do X Plugin do [[<code class="option">port</code>]].</td> </tr><tr> <td>open_win_firewall</td> <td>Classificação</td> <td>Firewall de janelas abertas, firewall aberto</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Verdade</td> <td>Configurar, reconfigurar</td> <td>enable-tcp-ip=true</td> <td>Cria regras do Firewall do Windows para conexões TCP/IP para as opções [[<code class="option">port</code>]] e [[<code class="option">mysqlx-port</code>]].</td> </tr><tr> <td>Tubos denominados "activar"</td> <td>Classificação</td> <td>tubos com nome</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Falso</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Indica se o servidor permite conexões através de um tubo nomeado.</td> </tr><tr> <td>embocadura</td> <td>Classificação</td> <td>nome-de-tubo, nome-de-tubo, nome-de-tubo, nome-de-tubo</td> <td>cordão</td> <td>Classificação</td> <td>MYSQL</td> <td>Configurar, reconfigurar</td> <td>enable-named-pipes=true</td> <td>Especifica o nome do pipeline a ser usado ao ouvir conexões locais que usam um pipeline nomeado. O valor padrão é MySQL, e não é sensível a maiúsculas e minúsculas.</td> </tr><tr> <td>nomeado-pipe-full-access-group</td> <td>Classificação</td> <td>grupo de acesso total</td> <td>cordão</td> <td>"",<span class="emphasis"><em>Todos .</em></span>, nome de grupo local Windows válido</td> <td>"" (cadeia vazia)</td> <td>Configurar, reconfigurar</td> <td>enable-named-pipes=true</td> <td>Define o nome de um grupo local do Windows cujos membros são concedidos acesso suficiente pelo servidor MySQL para usar clientes de named-pipe. O valor padrão é uma string vazia, o que significa que nenhum usuário do Windows tem acesso total ao named-pipe.</td> </tr><tr> <td>memória partilhada</td> <td>Classificação</td> <td>Ativar-memória partilhada</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Falso</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Se o servidor permite conexões de memória compartilhada.</td> </tr><tr> <td>nome-base-de-memória-compartilhada</td> <td>Classificação</td> <td>memória partilhada, memória partilhada</td> <td>cordão</td> <td>Classificação</td> <td>MYSQL</td> <td>Configurar, reconfigurar</td> <td>memória partilhada=true</td> <td>Nome da ligação de memória partilhada utilizada para comunicar com o servidor.</td> </tr><tr> <td>senha</td> <td>p</td> <td>pwd, palavra-passe raiz, passwordwd, rootpasswd</td> <td>cordão</td> <td>Classificação</td> <td>Classificação</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>A senha atribuída ao usuário raiz durante uma configuração ou reconfiguração. A senha não pode ser alterada durante uma reconfiguração, embora seja necessária para validar uma conexão com o servidor.</td> </tr><tr> <td>Configure-as-service</td> <td>Classificação</td> <td>As-windows-service, as-win-service</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Verdade</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Configura o servidor MySQL para ser executado como um serviço Windows. Por padrão, o serviço Windows é executado usando a Conta de Sistema Padrão (Serviço de Rede).</td> </tr><tr> <td>windows-serviço-nome</td> <td>Classificação</td> <td>nome do serviço, nome do serviço de ganho, nome do serviço</td> <td>cordão</td> <td>Classificação</td> <td>"MySQLxx" onde [[<code>xx</code>]] corresponde à versão principal e secundária do servidor.</td> <td>Configurar, reconfigurar</td> <td>Configure-as-service=true</td> <td>Nome dado ao serviço Windows utilizado para executar o MySQL Server.</td> </tr><tr> <td>Windows-service-auto-start</td> <td>Classificação</td> <td>Win-service-auto-start, serviço-auto-start, auto-start, auto-start</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Verdade</td> <td>Configurar, reconfigurar</td> <td>Configure-as-service=true</td> <td>Se configurado como um serviço do Windows, este valor define o serviço para iniciar automaticamente na inicialização do sistema.</td> </tr><tr> <td>windows-service-user</td> <td>Classificação</td> <td>win-service-user, usuário do serviço</td> <td>cordão</td> <td>Classificação</td> <td>NT AUTORIDADE</td> <td>Configurar, reconfigurar</td> <td>Configure-as-service=true</td> <td>Nome de uma conta de utilizador do Windows utilizada para executar o serviço do Windows.</td> </tr><tr> <td>senha do serviço windows</td> <td>Classificação</td> <td>serviço-password, serviço-pwd, serviço-password, serviço-pwd, sapass</td> <td>cordão</td> <td>Classificação</td> <td>"" (cadeia vazia)</td> <td>Configurar, reconfigurar</td> <td>Configure-as-service=true</td> <td>A senha da conta de utilizador do Windows utilizada para executar o serviço do Windows.</td> </tr><tr> <td>servidor-arquivo-permissões-acesso</td> <td>Classificação</td> <td>acesso ao servidor-arquivo</td> <td>Lista</td> <td>FullAccess, Configurar, Manual</td> <td>acesso total</td> <td>Configurar, atualizar</td> <td>Classificação</td> <td>Configura o acesso ao nível do utilizador para os ficheiros do servidor (directório de dados e quaisquer ficheiros dentro desse local).</td> </tr><tr> <td>servidor-arquivo-lista-de-controle-completa</td> <td>Classificação</td> <td>lista de controlo completa</td> <td>Lista separada por vírgula</td> <td>usuários/grupos de Windows</td> <td>usuário executando o serviço windows (se aplicável) e grupo Administradores</td> <td>Configurar, atualizar</td> <td>servidor-arquivo-permissões-acess=configurar</td> <td>Define uma lista de usuários ou grupos separados por vírgulas para ter acesso total aos arquivos do servidor.</td> </tr><tr> <td>servidor-arquivo-não-acessar-lista</td> <td>Classificação</td> <td>lista de não acesso</td> <td>Lista separada por vírgula</td> <td>usuários/grupos de Windows</td> <td>vazio</td> <td>Configurar, atualizar</td> <td>servidor-arquivo-permissões-acess=configurar</td> <td>Define uma lista separada por vírgulas de utilizadores ou grupos com acesso aos ficheiros do servidor.</td> </tr><tr> <td>Registro de erros</td> <td>Classificação</td> <td>ativar-erro-log</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Verdade</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Permite o registro de erros. O registro de erros contém um registro de tempos de inicialização e desligamento do mysqld. Ele também contém mensagens de diagnóstico, como erros, avisos e notas que ocorrem durante a inicialização e desligamento do servidor; e enquanto o servidor está em execução.</td> </tr><tr> <td>log-error (erro de registro)</td> <td>Classificação</td> <td>arquivo de registro de erros, nome de registro de erros</td> <td>Nome do caminho/arquivo</td> <td>Classificação</td> <td>{host_name}.err</td> <td>Configurar, reconfigurar</td> <td>Ativar-erro-log=true</td> <td>Define a localização do registo de erros. Se não for fornecido um caminho, a localização do ficheiro é o diretório de dados.</td> </tr><tr> <td>slow-query-log</td> <td>Classificação</td> <td>activar-slow-log</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Falso</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Se o registo de consultas lentas está habilitado.</td> </tr><tr> <td>slow-query-log-file</td> <td>Classificação</td> <td>slow-log-file, slowlogname</td> <td>Nome do ficheiro</td> <td>Classificação</td> <td>{host_name}-slow.log</td> <td>Configurar, reconfigurar</td> <td>slow-query-log=true</td> <td>O nome do arquivo de registo de consulta lenta.</td> </tr><tr> <td>Registro geral</td> <td>Classificação</td> <td>enable-general-log, generallog</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Falso</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Se o registo geral de consultas está habilitado.</td> </tr><tr> <td>ficheiro de registo geral</td> <td>Classificação</td> <td>nome de registo geral</td> <td>Nome do ficheiro</td> <td>Classificação</td> <td>{host_name}.log</td> <td>Configurar, reconfigurar</td> <td>general-log=true</td> <td>O nome do ficheiro de registo geral de consultas.</td> </tr><tr> <td>activar-log-bin</td> <td>Classificação</td> <td>enable-binary-log</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Verdade</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Permite o registo binário.</td> </tr><tr> <td>caixa de depósito</td> <td>Classificação</td> <td>Registro binário</td> <td>Nome do ficheiro</td> <td>Classificação</td> <td>{host_name}-bin</td> <td>Configurar, reconfigurar</td> <td>Ativar-log-bin=true</td> <td>Especifica o nome de base a ser usado para arquivos de log binário. Com o registro binário habilitado, o servidor registra todas as instruções que alteram dados para o log binário, que é usado para backup e replicação. O log binário é uma sequência de arquivos com um nome de base e extensão numérica.</td> </tr><tr> <td>Identificação do servidor</td> <td>Classificação</td> <td>Servidor</td> <td>número</td> <td>Classificação</td> <td>1 .</td> <td>Configuração</td> <td>Classificação</td> <td>Para servidores que são usados em uma topologia de replicação, você deve especificar um ID de servidor exclusivo para cada servidor de replicação no intervalo de 1 a 2 ^ 32 - 1. "Unico" significa que cada ID deve ser diferente de todos os outros ID em uso por qualquer outro servidor de origem ou réplica na topologia de replicação.</td> </tr><tr> <td>nomes de tabela em minúsculas</td> <td>Classificação</td> <td>Classificação</td> <td>Lista</td> <td>0, 1, 2</td> <td>1 .</td> <td>Configuração</td> <td>Classificação</td> <td>Se definido em 0, os nomes das tabelas são armazenados conforme especificado e as comparações são case-sensitivas. Se definido em 1, os nomes das tabelas são armazenados em minúsculas no disco e as comparações não são case-sensitivas. Se definido em 2, os nomes das tabelas são armazenados como dados, mas comparados em minúsculas. Esta opção também se aplica a nomes de banco de dados e aliases de tabelas.</td> </tr><tr> <td>instalar-modelo-base de dados</td> <td>Classificação</td> <td>instalar-exemplo-base de dados</td> <td>Lista</td> <td>Todos, Sakila, Mundo, Nenhum</td> <td>Nenhum</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Instala as bases de dados de amostra especificadas.</td> </tr><tr> <td>desinstalar-modelo-base de dados</td> <td>Classificação</td> <td>desinstalar-exemplo-base de dados</td> <td>Lista</td> <td>Todos, Sakila, Mundo, Nenhum</td> <td>Nenhum</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>Desinstala as bases de dados de amostra especificadas.</td> </tr><tr> <td>Protocolo de instância antiga</td> <td>Classificação</td> <td>Protocolo de instância existente</td> <td>Lista</td> <td>Socket, Sockets, Tcp, Pipe, NamedPipe, SharedMemory, Memória</td> <td>Classificação</td> <td>tcp-ip</td> <td>actualização</td> <td>O protocolo de ligação utilizado pela instância do servidor que está a ser actualizada.</td> </tr><tr> <td>Porto de instância antiga</td> <td>Classificação</td> <td>Porto de instância existente</td> <td>número</td> <td>Classificação</td> <td>Classificação</td> <td>actualização</td> <td>Classificação</td> <td>O número de porta a ser usado pela instância do servidor que está a ser atualizado quando se ouve para conexões TCP/IP</td> </tr><tr> <td>old-instance-pipe-name</td> <td>Classificação</td> <td>exist-instance-pipe-name</td> <td>cordão</td> <td>Classificação</td> <td>MYSQL</td> <td>actualização</td> <td>Classificação</td> <td>Especifica o nome do tubo a ser usado pela instância do servidor que está sendo atualizada ao ouvir conexões locais que usam um tubo nomeado.</td> </tr><tr> <td>old-instance-memory-name (nome da instância antiga)</td> <td>Classificação</td> <td>Nome da memória partilhada da instância antiga, nome da memória partilhada da instância existente, nome da memória partilhada da instância existente</td> <td>cordão</td> <td>Classificação</td> <td>MYSQL</td> <td>actualização</td> <td>Classificação</td> <td>Nome da ligação de memória partilhada utilizada pela instância do servidor que está a ser actualizada para comunicar com o servidor.</td> </tr><tr> <td>senha de instância antiga</td> <td>Classificação</td> <td>Antigos instâncias-pwd, Antigos instâncias-password, Existentes instâncias-pwd, Existentes instâncias-pwd, Existentes instâncias-pwd</td> <td>cordão</td> <td>Classificação</td> <td>Classificação</td> <td>actualização</td> <td>Classificação</td> <td>A palavra-passe do utilizador root utilizada pela instância do servidor que está a ser actualizada.</td> </tr><tr> <td>dados de reserva</td> <td>Classificação</td> <td>backup-data-directory</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Verdade</td> <td>actualização</td> <td>Classificação</td> <td>Cria um backup das bases de dados para garantir que os dados possam ser restaurados em caso de falha.</td> </tr><tr> <td>keep-data-directory</td> <td>Classificação</td> <td>Manutenção de dados</td> <td>embolsado</td> <td>Verdadeiro, falso</td> <td>Falso</td> <td>remover</td> <td>Classificação</td> <td>Impede que o diretório de dados seja excluído quando outras configurações são removidas.</td> </tr><tr> <td>Defaults-extra-file</td> <td>Classificação</td> <td>arquivo de senha, arquivo de senha, arquivo pwd</td> <td>Percurso</td> <td>Classificação</td> <td>Classificação</td> <td>Reconfigurar, atualizar</td> <td>Classificação</td> <td>O caminho e o nome do arquivo que contém a entrada [[<code class="option">password</code>]] que especifica a senha do usuário raiz.</td> </tr><tr> <td>windows-service-account-password-file</td> <td>Classificação</td> <td>windows-service-account-password-file, win-service-account-pass-file, service-account-pwd-file, win-service-account-pwd-file, service-account-password-file</td> <td>Percurso</td> <td>Classificação</td> <td>Classificação</td> <td>Configurar, reconfigurar</td> <td>Classificação</td> <td>O caminho e o nome do ficheiro do ficheiro que contém a entrada [[<code class="option">password</code>]] que especifica a palavra-passe da conta de utilizador do serviço Windows associada ao serviço Windows que executa o servidor.</td> </tr></tbody></table>

##### Gerenciamento de usuários MySQL

As ações de configuração e reconfiguração permitem criar e editar usuários do MySQL de acordo com a opção `--add-user`:

- - "password" "file\_path" "windows\_security\_token": "host:role:authentication"

  Apenas válido para a ação de configuração (não de reconfiguração).

O nome de usuário, a senha e o caminho do arquivo de token devem ser fechados em aspas simples ou duplas. Evite aspas simples, aspas duplas e as barras retrógradas se presentes no nome de usuário ou senha.

Adicionar exemplos de utilizadores:

```
mysql_configurator.exe --console --action=configure --add-user='john':'mypass12%':%:"Db Admin":MYSQL
mysql_configurator.exe --console --action=configure --add-user='jenny':'jenny-T480jenny':localhost:"Administrator":Windows
```

##### Exemplos gerais

Uma nova configuração:

```
# Simple
mysql_configurator.exe --console --action=configure --password=test

# More complex
mysql_configurator.exe --console --action=configure --password=test --port=3320 --enable-pipe-names --pipe-name=MYSQL_PIPE --server-id=2 --install-sample-database=both

# More complex, also with users
mysql_configurator.exe --console --action=configure --password=other123 --add-user='john':'pa$$':"Db Admin":MYSQL --add-user='mary':'p4ssW0rd':"Administrator":MYSQL
```

Uma reconfiguração:

```
# Basic reconfiguration
mysql_configurator.exe --console --action=reconfigure --password=test --port=3310

# Complex reconfiguration
mysql_configurator.exe --console --action=reconfigure --password=test --enable-shared-memory=false
```

Uma remoção:

```
mysql_configurator.exe --console --action=remove --keep-data-directory=true
```

Uma atualização:

```
# Basic removal
mysql_configurator.exe --console --action=upgrade --old-instance-password=test

# Complex removal
mysql_configurator.exe --console --action=upgrade --old-instance-password=test --backup-data=false --server-file-permissions-access=full
```

##### Gestão da senha raiz

Existem várias maneiras de passar a senha do usuário raiz, dependendo das necessidades em termos de segurança e simplicidade.

1. Passwords como argumentos da linha de comando:

   Passe no `--password` (para configuração e reconfiguração) ou `--old-instance-password` (para atualizações) para a linha de comando.
2. Defina senhas no arquivo de configuração do MySQL:

   Ter a entrada "password={password\_here}" diretamente no `my.ini` define a senha do usuário raiz.

   Ter a entrada "password={password\_here}" no arquivo de configuração extra (conforme `--defaults-extra-file`) pode definir a senha do usuário raiz.
3. Definição de senhas usando variáveis de ambiente:

   `MYSQL_PWD`: Semelhante ao cliente MySQL, o valor definido na variável de ambiente `MYSQL_PWD` pode definir a senha do usuário raiz se nenhum outro método foi usado para defini-lo. Esta variável se aplica às ações de configuração, reconfiguração e atualização.

   `WIN_SERVICE_ACCOUNT_PWD`: Esta variável de ambiente pode definir a senha do usuário da conta de serviço do Windows que está configurado para executar o MySQL Windows Service se o servidor foi configurado para ser executado como um serviço. Esta variável se aplica às ações de configuração e reconfiguração.
