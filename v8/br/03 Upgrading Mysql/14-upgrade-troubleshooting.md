## 3.13 Solução de problemas de atualização

- Um desajuste de esquema em uma instância do MySQL 8.3 entre o arquivo `.frm` de uma tabela e o dicionário de dados `InnoDB` pode fazer com que uma atualização para o MySQL 8.4 falhe. Tais desajustes podem ser devido à corrupção do arquivo `.frm`.
- Se ocorrerem problemas, como o novo servidor `mysqld` não iniciar, verifique se você não tem um arquivo `my.cnf` antigo de sua instalação anterior. Você pode verificar isso com a opção `--print-defaults` (por exemplo, `mysqld --print-defaults`). Se este comando exibir qualquer outra coisa além do nome do programa, você tem um arquivo `my.cnf` ativo que afeta a operação do servidor ou do cliente.
- Se, após uma atualização, você tiver problemas com programas compilados, como o `Commands out of sync` ou descargas inesperadas de núcleo, provavelmente você usou arquivos de cabeçalho ou biblioteca antigos ao compilar seus programas. Neste caso, verifique a data do seu arquivo `mysql.h` e da biblioteca `libmysqlclient.a` para verificar se eles são da nova distribuição do MySQL. Se não, recompile seus programas com os novos cabeçalhos e bibliotecas. A recompilação também pode ser necessária para programas compilados contra a biblioteca cliente compartilhada se o número de versão da biblioteca principal mudou (por exemplo, de `libmysqlclient.so.20` para `libmysqlclient.so.21`).
- Se você criou uma função carregável com um nome dado e atualizou o MySQL para uma versão que implementa uma nova função integrada com o mesmo nome, a função carregável torna-se inacessível. Para corrigir isso, use `DROP FUNCTION` para soltar a função carregável e, em seguida, use `CREATE FUNCTION` para recriar a função carregável com um nome diferente e não conflitante. O mesmo é verdade se a nova versão do MySQL implementa uma função integrada com o mesmo nome de uma função armazenada existente. Veja Seção 11.2.5,  Função de Análise de Nomes e Resolução, para as regras que descrevem como o servidor interpreta referências a diferentes tipos de funções.
- Se a atualização para o MySQL 8.4 falhar devido a qualquer um dos problemas descritos na Seção 3.6, o servidor reverterá todas as alterações no diretório de dados. Neste caso, remova todos os arquivos de registro de redirecionamento e reinicie o servidor MySQL 8.3 no diretório de dados existente para corrigir os erros. Os arquivos de registro de redirecionamento (`ib_logfile*`) residem no diretório de dados do MySQL por padrão. Depois que os erros forem corrigidos, execute um desligamento lento (definindo `innodb_fast_shutdown=0`) antes de tentar a atualização novamente.
