## 3.13 Solução de problemas de atualização

* Uma incompatibilidade de esquema em uma instância do MySQL 8.3 entre o arquivo `.frm` de uma tabela e o dicionário de dados `InnoDB` pode causar o fracasso da atualização para o MySQL 8.4. Tais incompatibilidades podem ser devidas à corrupção do arquivo `.frm`. Para resolver esse problema, faça o dump e o restore das tabelas afetadas antes de tentar a atualização novamente.
* Se ocorrerem problemas, como o novo servidor `mysqld` não iniciar, verifique se você não tem um arquivo `my.cnf` antigo da sua instalação anterior. Você pode verificar isso com a opção `--print-defaults` (por exemplo, `mysqld --print-defaults`). Se este comando exibir algo além do nome do programa, você tem um arquivo `my.cnf` ativo que afeta a operação do servidor ou do cliente.
* Se, após uma atualização, você experimentar problemas com programas cliente compilados, como `Comandos fora de sincronia` ou descargas inesperadas do núcleo, provavelmente você usou arquivos de cabeçalho ou bibliotecas antigos ao compilar seus programas. Neste caso, verifique a data do seu arquivo `mysql.h` e da biblioteca `libmysqlclient.a` para verificar se são da nova distribuição do MySQL. Se não forem, recompile seus programas com os novos cabeçalhos e bibliotecas. A recompilação também pode ser necessária para programas compilados contra a biblioteca cliente compartilhada se o número da versão principal da biblioteca tiver mudado (por exemplo, de `libmysqlclient.so.20` para `libmysqlclient.so.21`).
* Se você criou uma função carregável com um nome dado e atualizou o MySQL para uma versão que implementa uma nova função embutida com o mesmo nome, a função carregável torna-se inacessível. Para corrigir isso, use `DROP FUNCTION` para descartar a função carregável e, em seguida, use `CREATE FUNCTION` para recriar a função carregável com um nome diferente e não conflitante. O mesmo vale se a nova versão do MySQL implementar uma função embutida com o mesmo nome que uma função armazenada existente. Veja a Seção 11.2.5, “Parsing and Resolution of Function Names”, para as regras que descrevem como o servidor interpreta referências a diferentes tipos de funções.
* Se a atualização para o MySQL 8.4 falhar devido a algum dos problemas descritos na Seção 3.6, “Preparando sua instalação para atualização”, o servidor reverte todas as alterações no diretório de dados. Neste caso, remova todos os arquivos de log de redo e reinicie o servidor MySQL 8.3 no diretório de dados existente para corrigir os erros. Os arquivos de log de redo (`ib_logfile*`) residem no diretório de dados do MySQL por padrão. Após corrigir os erros, realize um desligamento lento (definindo `innodb_fast_shutdown=0`) antes de tentar a atualização novamente.

